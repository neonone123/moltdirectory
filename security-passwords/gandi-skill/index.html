<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Manage Gandi domains, DNS, email, and SSL certificates">
  <title>gandi-skill - OpenClaw Directory</title>
  <link rel="canonical" href="https://moltdirectory.com/security-passwords/gandi-skill/">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¦</text></svg>">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
  <script>
    // Apply saved theme before page renders to prevent flash
    (function() {
      const savedTheme = localStorage.getItem('theme') || 'dark';
      if (savedTheme === 'light') {
        document.documentElement.setAttribute('data-theme', 'light');
      }
    })();
  </script>
</head>
<body>
  <header class="header">
    <div class="header-inner">
      <a href="/" class="logo">

        <span class="logo-text">OpenClaw Directory</span>
      </a>
      <nav class="header-links">
        <a href="/start-here/" class="header-link">Start Here</a>
        <a href="/security-auditor" class="header-link">Security Auditor</a>
        <a href="https://github.com/neonone123/moltdirectory/issues/new?template=add-skill.yml" class="header-link" target="_blank" rel="noopener">Add Skill</a>
        <button class="theme-toggle" aria-label="Toggle theme" onclick="toggleTheme()">
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
        </button>
        <a href="https://www.reddit.com/r/OpenClawDirectory/" class="header-link" target="_blank" rel="noopener" aria-label="Community">
          <svg viewBox="0 0 16 16" fill="currentColor" width="28" height="28"><path d="M6.167 8a.83.83 0 0 0-.83.83c0 .459.372.84.83.831a.831.831 0 0 0 0-1.661m1.843 3.647c.315 0 1.403-.038 1.976-.611a.23.23 0 0 0 0-.306.213.213 0 0 0-.306 0c-.353.363-1.126.487-1.67.487-.545 0-1.308-.124-1.671-.487a.213.213 0 0 0-.306 0 .213.213 0 0 0 0 .306c.564.563 1.652.61 1.977.61zm.992-2.807c0 .458.373.83.831.83s.83-.381.83-.83a.831.831 0 0 0-1.66 0z"/><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.828-1.165c-.315 0-.602.124-.812.325-.801-.573-1.9-.945-3.121-.993l.534-2.501 1.738.372a.83.83 0 1 0 .83-.869.83.83 0 0 0-.744.468l-1.938-.41a.2.2 0 0 0-.153.028.2.2 0 0 0-.086.134l-.592 2.788c-1.24.038-2.358.41-3.17.992-.21-.2-.496-.324-.81-.324a1.163 1.163 0 0 0-.478 2.224q-.03.17-.029.353c0 1.795 2.091 3.256 4.669 3.256s4.668-1.451 4.668-3.256c0-.114-.01-.238-.029-.353.401-.181.688-.592.688-1.069 0-.65-.525-1.165-1.165-1.165"/></svg>
        </a>
      </nav>
    </div>
  </header>
  
          <section class="skill-page-header">
            <div class="skill-page-header-inner">
              <a href="/security-passwords/" class="back-link">â† Back to Security & Passwords</a>
              <div class="skill-page-meta">
                <a href="/security-passwords/" class="skill-page-category">Security & Passwords</a>
                <span class="skill-page-author">by @chrisagiddings</span>
              </div>
              <h1 class="skill-page-title">gandi-skill</h1>
              <p class="skill-page-desc">Manage Gandi domains, DNS, email, and SSL certificates</p>
              <div class="vote-widget skill-page-vote" data-category-id="security-passwords" data-tool-id="gandi-skill">
                <button type="button" class="vote-btn" data-vote="1" aria-label="Upvote gandi-skill">â–²</button>
                <span class="vote-count">New</span>
                <button type="button" class="vote-btn" data-vote="-1" aria-label="Downvote gandi-skill">â–¼</button>
              </div>
            </div>
          </section>
          <div class="skill-page-body">
            <article class="skill-page-content">
              <div class="skill-source-wrapper">
                <div class="skill-source-header">
                  <div class="skill-source-title">Source Code</div>
                  <button class="copy-btn" onclick="copySkillContent(this)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                    Copy
                  </button>
                </div>
                <div class="markdown-content">
                  <h1>Gandi Domain Registrar Skill</h1>
<p>Comprehensive Gandi domain registrar integration for Moltbot.</p>
<p><strong>Status:</strong> âœ… Phase 2 Complete - DNS modification &amp; snapshots functional</p>
<h2>âš ï¸ Security Warning</h2>
<p><strong>This skill can perform DESTRUCTIVE operations on your Gandi account:</strong></p>
<ul>
<li><strong>DNS Modification:</strong> Add, update, or delete DNS records (can break websites/email)</li>
<li><strong>Email Management:</strong> Create, modify, or delete email forwards (can intercept emails)</li>
<li><strong>Domain Registration:</strong> Register domains (creates financial transactions)</li>
<li><strong>Bulk Operations:</strong> Replace all DNS records at once (cannot be undone except via snapshots)</li>
</ul>
<p><strong>Before running ANY script:</strong></p>
<ol>
<li>Review the script code to understand what it does</li>
<li>Create DNS snapshots before bulk changes (<code>create-snapshot.js</code>)</li>
<li>Use read-only Personal Access Tokens where possible</li>
<li>Test on non-production domains first</li>
<li>Understand that some operations cannot be undone</li>
</ol>
<p><strong>Destructive scripts</strong> (âš ï¸ modify or delete data):</p>
<ul>
<li><code>add-dns-record.js</code>, <code>delete-dns-record.js</code>, <code>update-dns-bulk.js</code></li>
<li><code>add-email-forward.js</code>, <code>update-email-forward.js</code>, <code>delete-email-forward.js</code></li>
<li><code>restore-snapshot.js</code> (replaces current DNS)</li>
</ul>
<p><strong>Read-only scripts</strong> (âœ… safe, no modifications):</p>
<ul>
<li><code>list-domains.js</code>, <code>list-dns.js</code>, <code>list-snapshots.js</code></li>
<li><code>list-email-forwards.js</code>, <code>check-domain.js</code>, <code>check-ssl.js</code></li>
</ul>
<p>ğŸ“– <strong>For complete script documentation:</strong> See <a href="https://github.com/openclaw/skills/blob/main/skills/chrisagiddings/gandi-skill/SCRIPTS.md">SCRIPTS.md</a> for detailed information about:</p>
<ul>
<li>What each script does</li>
<li>Network operations and API calls</li>
<li>Security implications</li>
<li>Undo/recovery procedures</li>
<li>Audit workflow recommendations</li>
</ul>
<h2>Current Capabilities</h2>
<h3>Phase 1 (Complete)</h3>
<ul>
<li>âœ… Personal Access Token authentication</li>
<li>âœ… List domains in your account</li>
<li>âœ… Get domain details (expiration, status, services)</li>
<li>âœ… List DNS records for domains</li>
<li>âœ… View domain and DNS information</li>
<li>âœ… <strong>Domain availability checking</strong> (<a href="https://github.com/chrisagiddings/moltbot-gandi-skill/issues/4">#4</a>)</li>
<li>âœ… <strong>Smart domain suggestions with variations</strong> (<a href="https://github.com/chrisagiddings/moltbot-gandi-skill/issues/4">#4</a>)</li>
<li>âœ… SSL certificate status checker</li>
<li>âœ… Error handling and validation</li>
</ul>
<h3>Phase 2 (Complete)</h3>
<ul>
<li>âœ… <strong>Add/update DNS records</strong> (A, AAAA, CNAME, MX, TXT, NS, SRV, CAA, PTR)</li>
<li>âœ… <strong>Delete DNS records</strong></li>
<li>âœ… <strong>Bulk DNS operations</strong> (replace all records at once)</li>
<li>âœ… <strong>DNS zone snapshots</strong> (create, list, restore)</li>
<li>âœ… <strong>Email forwarding</strong> (create, list, update, delete forwards including catch-all)</li>
<li>âœ… <strong>Record validation</strong> (automatic validation for each record type)</li>
<li>âœ… <strong>Safety features</strong> (automatic snapshots before bulk changes, confirmation prompts)</li>
</ul>
<h2>Coming Soon (Phase 3+)</h2>
<ul>
<li>Domain registration</li>
<li>Multi-organization support (<a href="https://github.com/chrisagiddings/moltbot-gandi-skill/issues/1">#1</a>)</li>
<li>Gateway Console configuration (<a href="https://github.com/chrisagiddings/moltbot-gandi-skill/issues/3">#3</a>)</li>
<li>Domain renewal management</li>
<li>DNSSEC configuration</li>
<li>Certificate management</li>
<li>Email mailbox management (beyond forwarding)</li>
</ul>
<h2>Setup</h2>
<h3>Step 1: Create Personal Access Token</h3>
<p><strong>âš ï¸ Security Recommendation:</strong> Use the <strong>minimum required scopes</strong> for your use case.</p>
<ol>
<li><p>Go to <a href="https://admin.gandi.net/organizations/account/pat">Gandi Admin â†’ Personal Access Tokens</a></p>
</li>
<li><p>Click <strong>&quot;Create a token&quot;</strong></p>
</li>
<li><p>Select your organization</p>
</li>
<li><p>Choose scopes:</p>
<p><strong>Read-Only (Recommended for viewing only):</strong></p>
<ul>
<li>âœ… Domain: read (required for listing domains)</li>
<li>âœ… LiveDNS: read (required for viewing DNS records)</li>
<li>âœ… Email: read (required for viewing email forwards)</li>
</ul>
<p><strong>Write Access (Required for modifications - use with caution):</strong></p>
<ul>
<li>âš ï¸ LiveDNS: write (enables DNS modification, deletion, bulk operations)</li>
<li>âš ï¸ Email: write (enables email forward creation, updates, deletions)</li>
</ul>
</li>
<li><p>Copy the token (you won&#39;t see it again!)</p>
</li>
</ol>
<p><strong>Security Best Practices:</strong></p>
<ul>
<li>Create separate tokens for read-only vs. write operations</li>
<li>Use read-only tokens for routine checks/monitoring</li>
<li>Only use write tokens when actively making changes</li>
<li>Rotate tokens regularly (every 90 days recommended)</li>
<li>Delete unused tokens immediately</li>
<li><strong>Never share or commit tokens to version control</strong></li>
</ul>
<h3>Step 2: Store Token</h3>
<p>Scripts check for credentials in priority order:</p>
<ol>
<li><strong><code>GANDI_API_TOKEN</code> environment variable</strong> (checked first)</li>
<li><strong><code>~/.config/gandi/api_token</code> file</strong> (fallback if env var not set)</li>
</ol>
<p><strong>Choose the method that fits your workflow:</strong></p>
<h4>Option A: Environment Variable (Recommended for CI/CD)</h4>
<pre><code class="language-bash"># Set environment variable (replace YOUR_PAT with actual token)
export GANDI_API_TOKEN=&quot;YOUR_PERSONAL_ACCESS_TOKEN&quot;

# Add to shell profile for persistence (~/.bashrc, ~/.zshrc, etc.)
echo &#39;export GANDI_API_TOKEN=&quot;YOUR_PERSONAL_ACCESS_TOKEN&quot;&#39; &gt;&gt; ~/.bashrc
</code></pre>
<p><strong>Benefits:</strong></p>
<ul>
<li>âœ… CI/CD friendly (standard pattern for automation)</li>
<li>âœ… Container-ready (no file mounts needed)</li>
<li>âœ… Works with secret management tools (1Password, Vault, etc.)</li>
<li>âœ… Easy to switch between multiple tokens</li>
</ul>
<h4>Option B: File-based (Recommended for local development)</h4>
<pre><code class="language-bash"># Create config directory
mkdir -p ~/.config/gandi

# Store your token (replace YOUR_PAT with actual token)
echo &quot;YOUR_PERSONAL_ACCESS_TOKEN&quot; &gt; ~/.config/gandi/api_token

# Secure the file (owner read-only)
chmod 600 ~/.config/gandi/api_token
</code></pre>
<p><strong>Benefits:</strong></p>
<ul>
<li>âœ… Token persists across shell sessions</li>
<li>âœ… Secure file permissions (0600 = owner read-only)</li>
<li>âœ… No risk of exposing token in process list</li>
<li>âœ… Works offline (no external dependencies)</li>
</ul>
<h3>Step 3: Install Dependencies</h3>
<p><strong>Required:</strong> Node.js &gt;= 18.0.0</p>
<pre><code class="language-bash">cd gandi-skill/scripts

# Install npm dependencies
npm install

# Verify installation
npm list --depth=0
</code></pre>
<p><strong>Expected packages:</strong></p>
<ul>
<li>axios (HTTP client for Gandi API)</li>
<li>Any other dependencies listed in package.json</li>
</ul>
<p><strong>Troubleshooting:</strong></p>
<ul>
<li>If <code>node</code> or <code>npm</code> not found: Install Node.js from <a href="https://nodejs.org/">nodejs.org</a></li>
<li>If permission errors: Don&#39;t use <code>sudo</code> - fix npm permissions or use nvm</li>
<li>If package errors: Delete <code>node_modules/</code> and <code>package-lock.json</code>, then <code>npm install</code> again</li>
</ul>
<h3>Step 4: Test Authentication</h3>
<pre><code class="language-bash">cd gandi-skill/scripts
node test-auth.js
</code></pre>
<p>Expected output:</p>
<pre><code>âœ… Authentication successful!

Your organizations:
  1. Personal Account (uuid-here)
     Type: individual

ğŸ‰ You&#39;re ready to use the Gandi skill!
</code></pre>
<h3>Step 5: Setup Contact Information (Optional, for Domain Registration)</h3>
<p>If you plan to register domains, save your contact information once for reuse:</p>
<pre><code class="language-bash">cd gandi-skill/scripts
node setup-contact.js
</code></pre>
<p><strong>The script will prompt for:</strong></p>
<ul>
<li>Name (first and last)</li>
<li>Email address</li>
<li>Phone number (international format: +1.5551234567)</li>
<li>Street address</li>
<li>City</li>
<li>State/Province (for US: 2-letter code like OH, automatically formatted to US-OH)</li>
<li>ZIP/Postal code</li>
<li>Country (2-letter code: US, FR, etc.)</li>
<li>Type (individual or company)</li>
<li><strong>Privacy preference:</strong> Retain or auto-purge contact after registration</li>
</ul>
<p><strong>Contact information is saved to:</strong></p>
<ul>
<li><code>~/.config/gandi/contact.json</code></li>
<li>Permissions: 600 (owner read-write only)</li>
<li>Outside the skill directory (never committed to git)</li>
</ul>
<p><strong>Privacy Options:</strong></p>
<ol>
<li><p><strong>RETAIN (default):</strong> Keep contact saved for future registrations</p>
<ul>
<li>Best for frequent domain registrations</li>
<li>Setup once, use forever</li>
<li>Delete manually anytime with <code>delete-contact.js</code></li>
</ul>
</li>
<li><p><strong>PURGE:</strong> Auto-delete contact after each registration</p>
<ul>
<li>Best for privacy-conscious users</li>
<li>Contact info only exists during registration</li>
<li>Must re-enter for next registration</li>
</ul>
</li>
</ol>
<p><strong>Managing saved contact:</strong></p>
<pre><code class="language-bash"># View current contact
node view-contact.js

# Update contact info or privacy preference
node setup-contact.js

# Delete saved contact manually
node delete-contact.js

# Delete without confirmation
node delete-contact.js --force
</code></pre>
<p><strong>One-time purge override:</strong></p>
<pre><code class="language-bash"># Register and delete contact (even if preference is &quot;retain&quot;)
node register-domain.js example.com --purge-contact
</code></pre>
<h2>Usage Examples</h2>
<h3>List Your Domains</h3>
<pre><code class="language-bash">node list-domains.js
</code></pre>
<p>Output shows:</p>
<ul>
<li>Domain names</li>
<li>Expiration dates</li>
<li>Auto-renewal status</li>
<li>Services (LiveDNS, Email, etc.)</li>
<li>Organization ownership</li>
</ul>
<h3>List DNS Records</h3>
<pre><code class="language-bash">node list-dns.js example.com
</code></pre>
<p>Output shows:</p>
<ul>
<li>All DNS records grouped by type</li>
<li>TTL values</li>
<li>Record names and values</li>
<li>Nameservers</li>
</ul>
<h3>Using from Moltbot</h3>
<p>Once configured, you can use natural language:</p>
<blockquote>
<p>&quot;List my Gandi domains&quot;</p>
</blockquote>
<blockquote>
<p>&quot;Show DNS records for example.com&quot;</p>
</blockquote>
<blockquote>
<p>&quot;When does example.com expire?&quot;</p>
</blockquote>
<blockquote>
<p>&quot;Is auto-renewal enabled for example.com?&quot;</p>
</blockquote>
<h2>Domain Availability Checking</h2>
<h3>Check Single Domain</h3>
<p>Check if a specific domain is available for registration:</p>
<pre><code class="language-bash">node check-domain.js example.com
</code></pre>
<p><strong>Features:</strong></p>
<ul>
<li>Shows availability status (available/unavailable/pending/error)</li>
<li>Displays pricing information (registration, renewal, transfer)</li>
<li>Lists supported features (DNSSEC, LiveDNS, etc.)</li>
<li>Shows TLD information</li>
</ul>
<p><strong>Example Output:</strong></p>
<pre><code>ğŸ” Checking availability for: example.com

Domain: example.com

âœ… Status: AVAILABLE

ğŸ’° Pricing:
  1 year: 12.00 EUR (+ 2.40 tax)
  2 years: 24.00 EUR (+ 4.80 tax)

ğŸ“‹ Supported Features:
  â€¢ create
  â€¢ dnssec
  â€¢ livedns

ğŸŒ TLD Information:
  Extension: com
</code></pre>
<h3>Smart Domain Suggestions</h3>
<p>Find available alternatives with TLD variations and name modifications:</p>
<pre><code class="language-bash"># Check all configured TLDs + variations
node suggest-domains.js example

# Check specific TLDs only
node suggest-domains.js example --tlds com,net,io

# Skip name variations (only check TLDs)
node suggest-domains.js example --no-variations

# Output as JSON
node suggest-domains.js example --json
</code></pre>
<p><strong>Name Variation Patterns:</strong></p>
<ol>
<li><strong>Hyphenated</strong>: Adds hyphens between word boundaries (<code>example</code> â†’ <code>ex-ample</code>)</li>
<li><strong>Abbreviated</strong>: Removes vowels (<code>example</code> â†’ <code>exmpl</code>)</li>
<li><strong>Prefix</strong>: Adds common prefixes (<code>example</code> â†’ <code>get-example</code>, <code>my-example</code>)</li>
<li><strong>Suffix</strong>: Adds common suffixes (<code>example</code> â†’ <code>example-app</code>, <code>example-hub</code>)</li>
<li><strong>Numbers</strong>: Appends numbers (<code>example</code> â†’ <code>example2</code>, <code>example3</code>)</li>
</ol>
<p><strong>Example Output:</strong></p>
<pre><code>ğŸ” Checking availability for: example

ğŸ“Š Checking 13 TLDs and generating variations...

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‹ EXACT MATCHES (Different TLDs)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Available:

  example.net                    12.00 EUR
  example.io                     39.00 EUR
  example.dev                    15.00 EUR

âŒ Unavailable:

  example.com                    (unavailable)
  example.org                    (unavailable)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¨ NAME VARIATIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Hyphenated:

  âœ… ex-ample.com                12.00 EUR

Prefix:

  âœ… get-example.com             12.00 EUR
  âœ… my-example.com              12.00 EUR

Suffix:

  âœ… example-app.com             12.00 EUR
  âœ… example-io.com              12.00 EUR

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š SUMMARY: 8 available domains found
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</code></pre>
<h3>Configuration</h3>
<p>Domain checker configuration is stored in <code>gandi-skill/config/domain-checker-defaults.json</code>.</p>
<p><strong>Structure:</strong></p>
<pre><code class="language-json">{
  &quot;tlds&quot;: {
    &quot;mode&quot;: &quot;extend&quot;,
    &quot;defaults&quot;: [&quot;com&quot;, &quot;net&quot;, &quot;org&quot;, &quot;info&quot;, &quot;io&quot;, &quot;dev&quot;, &quot;app&quot;, &quot;ai&quot;, &quot;tech&quot;],
    &quot;custom&quot;: []
  },
  &quot;variations&quot;: {
    &quot;enabled&quot;: true,
    &quot;patterns&quot;: [&quot;hyphenated&quot;, &quot;abbreviated&quot;, &quot;prefix&quot;, &quot;suffix&quot;, &quot;numbers&quot;],
    &quot;prefixes&quot;: [&quot;get&quot;, &quot;my&quot;, &quot;the&quot;, &quot;try&quot;],
    &quot;suffixes&quot;: [&quot;app&quot;, &quot;hub&quot;, &quot;io&quot;, &quot;ly&quot;, &quot;ai&quot;, &quot;hq&quot;],
    &quot;maxNumbers&quot;: 3
  },
  &quot;rateLimit&quot;: {
    &quot;maxConcurrent&quot;: 3,
    &quot;delayMs&quot;: 200,
    &quot;maxRequestsPerMinute&quot;: 100
  },
  &quot;limits&quot;: {
    &quot;maxTlds&quot;: 5,
    &quot;maxVariations&quot;: 10
  }
}
</code></pre>
<p><strong>Rate Limiting &amp; Limits:</strong></p>
<ul>
<li><strong>maxConcurrent</strong>: Maximum concurrent API requests (default: 3)</li>
<li><strong>delayMs</strong>: Delay between requests in milliseconds (default: 200ms)</li>
<li><strong>maxRequestsPerMinute</strong>: Hard limit on requests per minute (default: 100, Gandi allows 1000)</li>
<li><strong>maxTlds</strong>: Maximum TLDs to check in suggest-domains.js (default: 5)</li>
<li><strong>maxVariations</strong>: Maximum name variations to generate (default: 10)</li>
</ul>
<p>These limits ensure good API citizenship and prevent overwhelming Gandi&#39;s API.</p>
<p><strong>TLD Modes:</strong></p>
<ul>
<li><code>&quot;extend&quot;</code>: Use defaults + custom TLDs (merged list)</li>
<li><code>&quot;replace&quot;</code>: Use only custom TLDs (ignore defaults)</li>
</ul>
<p><strong>Gateway Console Integration:</strong></p>
<p>When Gateway Console support is added (<a href="https://github.com/chrisagiddings/moltbot-gandi-skill/issues/3">#3</a>), configuration will be available at:</p>
<pre><code class="language-yaml">skills:
  entries:
    gandi:
      config:
        domainChecker:
          tlds:
            mode: extend
            defaults: [...]
            custom: [...]
          variations:
            enabled: true
            patterns: [...]
</code></pre>
<p>See <code>docs/gateway-config-design.md</code> for complete configuration architecture.</p>
<h2>DNS Management (Phase 2)</h2>
<h3>Add or Update DNS Records</h3>
<p>Create or update individual DNS records:</p>
<pre><code class="language-bash"># Add an A record for root domain
node add-dns-record.js example.com @ A 192.168.1.1

# Add www subdomain pointing to root
node add-dns-record.js example.com www CNAME @

# Add MX record for email
node add-dns-record.js example.com @ MX &quot;10 mail.example.com.&quot;

# Add TXT record for SPF
node add-dns-record.js example.com @ TXT &quot;v=spf1 include:_spf.google.com ~all&quot;

# Add with custom TTL (5 minutes)
node add-dns-record.js example.com api A 192.168.1.10 300
</code></pre>
<p><strong>Supported record types:</strong> A, AAAA, CNAME, MX, TXT, NS, SRV, CAA, PTR</p>
<h3>Delete DNS Records</h3>
<p>Remove specific DNS records:</p>
<pre><code class="language-bash"># Delete old A record
node delete-dns-record.js example.com old A

# Delete with confirmation prompt
node delete-dns-record.js example.com test CNAME

# Delete without confirmation
node delete-dns-record.js example.com old A --force
</code></pre>
<h3>Bulk DNS Operations</h3>
<p>Replace all DNS records at once:</p>
<pre><code class="language-bash"># From JSON file
node update-dns-bulk.js example.com new-records.json

# From stdin
cat records.json | node update-dns-bulk.js example.com

# Skip automatic snapshot
node update-dns-bulk.js example.com records.json --no-snapshot

# Skip confirmation
node update-dns-bulk.js example.com records.json --force
</code></pre>
<p><strong>JSON format:</strong></p>
<pre><code class="language-json">[
  {
    &quot;rrset_name&quot;: &quot;@&quot;,
    &quot;rrset_type&quot;: &quot;A&quot;,
    &quot;rrset_ttl&quot;: 10800,
    &quot;rrset_values&quot;: [&quot;192.168.1.1&quot;]
  },
  {
    &quot;rrset_name&quot;: &quot;www&quot;,
    &quot;rrset_type&quot;: &quot;CNAME&quot;,
    &quot;rrset_ttl&quot;: 10800,
    &quot;rrset_values&quot;: [&quot;@&quot;]
  },
  {
    &quot;rrset_name&quot;: &quot;@&quot;,
    &quot;rrset_type&quot;: &quot;MX&quot;,
    &quot;rrset_ttl&quot;: 10800,
    &quot;rrset_values&quot;: [&quot;10 mail.example.com.&quot;, &quot;20 mail2.example.com.&quot;]
  }
]
</code></pre>
<h3>DNS Zone Snapshots</h3>
<p>Create safety backups before making changes:</p>
<pre><code class="language-bash"># Create a snapshot
node create-snapshot.js example.com &quot;Before migration&quot;

# List all snapshots
node list-snapshots.js example.com

# Restore from a snapshot
node restore-snapshot.js example.com abc123-def456-ghi789

# Restore without confirmation
node restore-snapshot.js example.com abc123-def456-ghi789 --force
</code></pre>
<p><strong>Automatic snapshots:</strong></p>
<ul>
<li>Bulk updates automatically create snapshots (unless <code>--no-snapshot</code>)</li>
<li>Snapshots are named with timestamp</li>
<li>Use snapshots for easy rollback</li>
</ul>
<h3>Common DNS Configuration Examples</h3>
<h4>Basic Website Setup</h4>
<pre><code class="language-bash"># Root domain
node add-dns-record.js example.com @ A 192.168.1.1

# WWW subdomain
node add-dns-record.js example.com www CNAME @
</code></pre>
<h4>Email Configuration (Google Workspace)</h4>
<pre><code class="language-bash"># MX records
node add-dns-record.js example.com @ MX &quot;1 ASPMX.L.GOOGLE.COM.&quot;
node add-dns-record.js example.com @ MX &quot;5 ALT1.ASPMX.L.GOOGLE.COM.&quot;
node add-dns-record.js example.com @ MX &quot;5 ALT2.ASPMX.L.GOOGLE.COM.&quot;

# SPF record
node add-dns-record.js example.com @ TXT &quot;v=spf1 include:_spf.google.com ~all&quot;
</code></pre>
<h4>Domain Redirect Setup</h4>
<p>To redirect one domain to another:</p>
<pre><code class="language-bash"># Point root domain to same server
node add-dns-record.js old-domain.com @ A 192.168.1.1

# Point www to same CNAME
node add-dns-record.js old-domain.com www CNAME @
</code></pre>
<p>Then configure HTTP 301 redirect at the server level.</p>
<h4>Subdomain Setup</h4>
<pre><code class="language-bash"># API subdomain
node add-dns-record.js example.com api A 192.168.1.10

# Staging subdomain
node add-dns-record.js example.com staging A 192.168.1.20

# Wildcard subdomain
node add-dns-record.js example.com &quot;*&quot; A 192.168.1.100
</code></pre>
<h2>Email Forwarding (Phase 2)</h2>
<h3>List Email Forwards</h3>
<p>See all email forwards configured for a domain:</p>
<pre><code class="language-bash">node list-email-forwards.js example.com
</code></pre>
<h3>Create Email Forwards</h3>
<p>Forward emails to one or more destinations:</p>
<pre><code class="language-bash"># Simple forward
node add-email-forward.js example.com hello you@personal.com

# Forward to multiple destinations
node add-email-forward.js example.com support team1@example.com team2@example.com

# Catch-all forward (forwards all unmatched emails)
node add-email-forward.js example.com @ catchall@example.com
</code></pre>
<h3>Update Email Forwards</h3>
<p>Change the destination(s) for an existing forward:</p>
<pre><code class="language-bash"># Update single destination
node update-email-forward.js example.com hello newemail@personal.com

# Update to multiple destinations
node update-email-forward.js example.com support new1@example.com new2@example.com
</code></pre>
<p><strong>Note:</strong> This replaces all existing destinations with the new ones.</p>
<h3>Delete Email Forwards</h3>
<p>Remove email forwards:</p>
<pre><code class="language-bash"># Delete with confirmation prompt
node delete-email-forward.js example.com old

# Delete without confirmation
node delete-email-forward.js example.com old --force

# Delete catch-all forward
node delete-email-forward.js example.com @ --force
</code></pre>
<h3>Common Email Forwarding Use Cases</h3>
<h4>Basic Email Forwarding</h4>
<pre><code class="language-bash"># Forward contact@ to your personal email
node add-email-forward.js example.com contact you@gmail.com

# Forward sales@ to team
node add-email-forward.js example.com sales team@example.com
</code></pre>
<h4>Domain Migration Email Forwarding</h4>
<pre><code class="language-bash"># Forward all email from old domain to new domain
# Preserves the local part (username before @)

# First, list existing forwards on old domain
node list-email-forwards.js old-domain.com

# Then create matching forwards on new domain
node add-email-forward.js old-domain.com contact contact@new-domain.com
node add-email-forward.js old-domain.com support support@new-domain.com

# Or use catch-all to forward everything
node add-email-forward.js old-domain.com @ admin@new-domain.com
</code></pre>
<h4>Team Distribution Lists</h4>
<pre><code class="language-bash"># Forward to entire team
node add-email-forward.js example.com team alice@example.com bob@example.com charlie@example.com

# Update team members
node update-email-forward.js example.com team alice@example.com dave@example.com
</code></pre>
<h4>Catch-All Configuration</h4>
<pre><code class="language-bash"># Forward all unmatched emails to one address
node add-email-forward.js example.com @ catchall@example.com

# Forward all unmatched emails to multiple addresses
node add-email-forward.js example.com @ admin1@example.com admin2@example.com
</code></pre>
<p><strong>Note:</strong> Catch-all forwards only apply to email addresses that don&#39;t have specific forwards configured.</p>
<h3>Email Forward Management Tips</h3>
<ol>
<li><strong>Test after creating:</strong> Send a test email to verify forwarding works</li>
<li><strong>Use specific forwards over catch-all:</strong> More control and easier to manage</li>
<li><strong>Multiple destinations:</strong> Email is sent to all destinations (not round-robin)</li>
<li><strong>Order doesn&#39;t matter:</strong> Gandi processes most specific match first</li>
<li><strong>Check spam folders:</strong> Forwarded emails may be filtered by recipient&#39;s spam filter</li>
</ol>
<h3>Example: Complete Domain Email Setup</h3>
<pre><code class="language-bash"># 1. Set up MX records (if not already done)
node add-dns-record.js example.com @ MX &quot;10 spool.mail.gandi.net.&quot;
node add-dns-record.js example.com @ MX &quot;50 fb.mail.gandi.net.&quot;

# 2. Create specific forwards
node add-email-forward.js example.com hello you@personal.com
node add-email-forward.js example.com support team@example.com
node add-email-forward.js example.com sales sales-team@example.com

# 3. Set up catch-all for everything else
node add-email-forward.js example.com @ admin@example.com

# 4. List all forwards to verify
node list-email-forwards.js example.com
</code></pre>
<h2>Helper Scripts</h2>
<p>All scripts are in <code>gandi-skill/scripts/</code>:</p>
<h3>Authentication &amp; Setup</h3>
<table>
<thead>
<tr>
<th>Script</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>test-auth.js</code></td>
<td>Verify authentication works</td>
</tr>
<tr>
<td><code>setup-contact.js</code></td>
<td>Save contact info for domain registration (run once)</td>
</tr>
<tr>
<td><code>view-contact.js</code></td>
<td>View saved contact information</td>
</tr>
<tr>
<td><code>delete-contact.js</code></td>
<td>Delete saved contact (with optional --force)</td>
</tr>
</tbody></table>
<h3>Domain &amp; DNS Viewing</h3>
<table>
<thead>
<tr>
<th>Script</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>list-domains.js</code></td>
<td>Show all domains in account</td>
</tr>
<tr>
<td><code>list-dns.js &lt;domain&gt;</code></td>
<td>Show DNS records for domain</td>
</tr>
<tr>
<td><code>check-domain.js &lt;domain&gt;</code></td>
<td>Check single domain availability + pricing</td>
</tr>
<tr>
<td><code>suggest-domains.js &lt;name&gt;</code></td>
<td>Smart domain suggestions with variations</td>
</tr>
<tr>
<td><code>check-ssl.js</code></td>
<td>Check SSL certificate status for all domains</td>
</tr>
</tbody></table>
<h3>DNS Modification (Phase 2)</h3>
<table>
<thead>
<tr>
<th>Script</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>add-dns-record.js &lt;domain&gt; &lt;name&gt; &lt;type&gt; &lt;value&gt; [ttl]</code></td>
<td>Add or update a DNS record</td>
</tr>
<tr>
<td><code>delete-dns-record.js &lt;domain&gt; &lt;name&gt; &lt;type&gt; [--force]</code></td>
<td>Delete a DNS record</td>
</tr>
<tr>
<td><code>update-dns-bulk.js &lt;domain&gt; &lt;records.json&gt; [--no-snapshot] [--force]</code></td>
<td>Bulk update all DNS records</td>
</tr>
<tr>
<td><code>list-snapshots.js &lt;domain&gt;</code></td>
<td>List DNS zone snapshots</td>
</tr>
<tr>
<td><code>create-snapshot.js &lt;domain&gt; [name]</code></td>
<td>Create a DNS zone snapshot</td>
</tr>
<tr>
<td><code>restore-snapshot.js &lt;domain&gt; &lt;snapshot-id&gt; [--force]</code></td>
<td>Restore DNS zone from snapshot</td>
</tr>
</tbody></table>
<h3>Email Forwarding (Phase 2)</h3>
<table>
<thead>
<tr>
<th>Script</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>list-email-forwards.js &lt;domain&gt;</code></td>
<td>List all email forwards for a domain</td>
</tr>
<tr>
<td><code>add-email-forward.js &lt;domain&gt; &lt;mailbox&gt; &lt;destination&gt; [dest2...]</code></td>
<td>Create email forward (use @ for catch-all)</td>
</tr>
<tr>
<td><code>update-email-forward.js &lt;domain&gt; &lt;mailbox&gt; &lt;destination&gt; [dest2...]</code></td>
<td>Update email forward destinations</td>
</tr>
<tr>
<td><code>delete-email-forward.js &lt;domain&gt; &lt;mailbox&gt; [--force]</code></td>
<td>Delete email forward</td>
</tr>
</tbody></table>
<h3>Core Library</h3>
<table>
<thead>
<tr>
<th>Script</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>gandi-api.js</code></td>
<td>Core API client (importable)</td>
</tr>
</tbody></table>
<h2>Configuration</h2>
<h3>Default Configuration</h3>
<ul>
<li><strong>Token file:</strong> <code>~/.config/gandi/api_token</code> (API authentication)</li>
<li><strong>Contact file:</strong> <code>~/.config/gandi/contact.json</code> (domain registration info, optional)</li>
<li><strong>API URL:</strong> <code>https://api.gandi.net</code> (production)</li>
</ul>
<h3>Sandbox Testing</h3>
<p>To use Gandi&#39;s sandbox environment:</p>
<pre><code class="language-bash"># Create sandbox token at: https://admin.sandbox.gandi.net
echo &quot;YOUR_SANDBOX_TOKEN&quot; &gt; ~/.config/gandi/api_token
echo &quot;https://api.sandbox.gandi.net&quot; &gt; ~/.config/gandi/api_url
</code></pre>
<h2>Troubleshooting</h2>
<h3>Token Not Found</h3>
<pre><code class="language-bash"># Verify file exists
ls -la ~/.config/gandi/api_token

# Should show: -rw------- (600 permissions)
</code></pre>
<h3>Authentication Failed (401)</h3>
<ul>
<li>Token is incorrect or expired</li>
<li>Create new token at Gandi Admin</li>
<li>Update stored token file</li>
</ul>
<h3>Permission Denied (403)</h3>
<ul>
<li>Token doesn&#39;t have required scopes</li>
<li>Create new token with Domain:read and LiveDNS:read</li>
<li>Verify organization membership</li>
</ul>
<h3>Domain Not Using LiveDNS</h3>
<p>If you get &quot;not using Gandi LiveDNS&quot; error:</p>
<ol>
<li>Log in to Gandi Admin</li>
<li>Go to domain management</li>
<li>Attach LiveDNS service to the domain</li>
</ol>
<h3>Rate Limit (429)</h3>
<p>Gandi allows 1000 requests/minute. If exceeded:</p>
<ul>
<li>Wait 60 seconds</li>
<li>Reduce frequency of API calls</li>
</ul>
<h2>API Reference</h2>
<p>The skill provides importable functions:</p>
<pre><code class="language-javascript">import { 
  testAuth,
  listDomains,
  getDomain,
  listDnsRecords,
  getDnsRecord,
  checkAvailability
} from &#39;./gandi-api.js&#39;;

// Test authentication
const auth = await testAuth();

// List domains
const domains = await listDomains();

// Get domain info
const domain = await getDomain(&#39;example.com&#39;);

// List DNS records
const records = await listDnsRecords(&#39;example.com&#39;);

// Get specific DNS record
const record = await getDnsRecord(&#39;example.com&#39;, &#39;@&#39;, &#39;A&#39;);

// Check availability
const available = await checkAvailability([&#39;example.com&#39;, &#39;example.net&#39;]);
</code></pre>
<h2>Security</h2>
<h3>Token Storage</h3>
<p>âœ… <strong>DO:</strong></p>
<ul>
<li>Store at <code>~/.config/gandi/api_token</code></li>
<li>Use 600 permissions (owner read-only)</li>
<li>Rotate tokens regularly</li>
<li>Use minimal required scopes</li>
</ul>
<p>âŒ <strong>DON&#39;T:</strong></p>
<ul>
<li>Commit tokens to repositories</li>
<li>Share tokens between users</li>
<li>Give tokens unnecessary permissions</li>
<li>Store tokens in scripts</li>
</ul>
<h3>Token Scopes</h3>
<p><strong>Phase 1 (current):</strong></p>
<ul>
<li>Domain: read</li>
<li>LiveDNS: read</li>
</ul>
<p><strong>Phase 2+ (future):</strong></p>
<ul>
<li>Domain: read, write (for registration, renewal)</li>
<li>LiveDNS: read, write (for DNS modifications)</li>
<li>Certificate: read (optional, for SSL certs)</li>
<li>Email: read, write (optional, for email config)</li>
</ul>
<h2>Architecture</h2>
<pre><code>gandi-skill/
â”œâ”€â”€ SKILL.md                 # This file
â”œâ”€â”€ references/              # API documentation
â”‚   â”œâ”€â”€ api-overview.md
â”‚   â”œâ”€â”€ authentication.md
â”‚   â”œâ”€â”€ domains.md
â”‚   â”œâ”€â”€ livedns.md
â”‚   â””â”€â”€ setup.md
â””â”€â”€ scripts/                 # Helper utilities
    â”œâ”€â”€ package.json
    â”œâ”€â”€ gandi-api.js         # Core API client
    â”œâ”€â”€ test-auth.js         # Test authentication
    â”œâ”€â”€ list-domains.js      # List domains
    â””â”€â”€ list-dns.js          # List DNS records
</code></pre>
<h2>Development Roadmap</h2>
<p><strong>Phase 1: Read Operations</strong> (âœ… Current)</p>
<ul>
<li>Authentication with PAT</li>
<li>List domains</li>
<li>Get domain details</li>
<li>List DNS records</li>
<li>Basic error handling</li>
</ul>
<p><strong>Phase 2: DNS Modifications</strong></p>
<ul>
<li>Add DNS records</li>
<li>Update DNS records</li>
<li>Delete DNS records</li>
<li>Bulk DNS operations</li>
</ul>
<p><strong>Phase 3: Domain Management</strong></p>
<ul>
<li>Domain registration</li>
<li>Domain renewal</li>
<li>Auto-renewal configuration</li>
<li>Nameserver management</li>
</ul>
<p><strong>Phase 4: Multi-Organization</strong> (<a href="https://github.com/chrisagiddings/moltbot-gandi-skill/issues/1">#1</a>)</p>
<ul>
<li>Profile-based token management</li>
<li>Organization selection</li>
<li>Multiple token support</li>
</ul>
<p><strong>Phase 5: Advanced Features</strong></p>
<ul>
<li>DNSSEC management</li>
<li>Certificate management</li>
<li>Email/mailbox configuration</li>
<li>Domain transfer operations</li>
</ul>
<h2>Contributing</h2>
<p>See <a href="https://github.com/openclaw/skills/blob/main/skills/chrisagiddings/gandi-skill/../../README.md#contributing">Contributing Guide</a> in the main README.</p>
<h2>Support</h2>
<ul>
<li><strong>Issues:</strong> <a href="https://github.com/chrisagiddings/moltbot-gandi-skill/issues">GitHub Issues</a></li>
<li><strong>Documentation:</strong> <a href="https://github.com/openclaw/skills/blob/main/skills/chrisagiddings/gandi-skill/./references/">Reference Guides</a></li>
<li><strong>Gandi Support:</strong> <a href="https://help.gandi.net/">help.gandi.net</a></li>
</ul>
<h2>License</h2>
<p>MIT License - See <a href="../../LICENSE">LICENSE</a></p>

                </div>
              </div>
            </article>
            <aside class="skill-page-sidebar">
              <div class="sidebar-card">
                <div class="sidebar-title">Actions</div>
                <a href="https://github.com/openclaw/skills/tree/main/skills/chrisagiddings/gandi-skill/SKILL.md" target="_blank" rel="noopener" class="sidebar-btn sidebar-btn-primary">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/></svg>
                  View on GitHub
                </a>
                <a href="https://clawdhub.com/chrisagiddings/gandi-skill" target="_blank" rel="noopener" class="sidebar-btn sidebar-btn-clawdhub">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/><line x1="2" y1="12" x2="22" y2="12"/></svg>
                  View on ClawdHub
                </a>
                <a href="https://raw.githubusercontent.com/openclaw/skills/main/skills/chrisagiddings/gandi-skill/SKILL.md" download="SKILL.md" class="sidebar-btn sidebar-btn-secondary">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                  Download SKILL.md
                </a>
                <button onclick="sendToSecurityAuditor()" class="sidebar-btn sidebar-btn-security">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                  Security Check
                </button>
              </div>
              <div class="sidebar-card">
                <div class="sidebar-title">Details</div>
                <div class="sidebar-info">
                  <div class="sidebar-info-item">
                    <span class="sidebar-info-label">Author</span>
                    <span class="sidebar-info-value">@chrisagiddings</span>
                  </div>
                  <div class="sidebar-info-item">
                    <span class="sidebar-info-label">Category</span>
                    <span class="sidebar-info-value">Security & Passwords</span>
                  </div>
                </div>
              </div>
            </aside>
          </div>
        
  <footer class="footer">
    <div class="footer-inner">
      <p class="footer-text" style="margin-bottom: 8px;"><a href="https://github.com/neonone123/moltdirectory" target="_blank" rel="noopener" style="color: var(--accent); text-decoration: none;">View on GitHub</a></p>
      <p class="footer-text" style="opacity: 0.6; font-size: 13px;">OpenClawDirectory.com is a community-run project and is not affiliated with the official OpenClaw team or Peter Steinberger. We are just fans of the lobster.</p>
    </div>
  </footer>
  <script>
    function toggleTheme() {
      const html = document.documentElement;
      const currentTheme = html.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      if (newTheme === 'light') {
        html.setAttribute('data-theme', 'light');
      } else {
        html.removeAttribute('data-theme');
      }
      localStorage.setItem('theme', newTheme);
    }
    
    function copySkillContent(btn) {
      const wrapper = btn.closest('.skill-source-wrapper');
      const content = wrapper.querySelector('.markdown-content');
      if (content) {
        const text = content.innerText || content.textContent;
        navigator.clipboard.writeText(text).then(() => {
          btn.classList.add('copied');
          btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg> Copied!';
          setTimeout(() => {
            btn.classList.remove('copied');
            btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copy';
          }, 2000);
        });
      }
    }

    async function sendToSecurityAuditor() {
      try {
        const contentElement = document.querySelector('.markdown-content');
        if (!contentElement) throw new Error('Could not find markdown content');
        const skillContent = contentElement.innerText || contentElement.textContent;
        localStorage.setItem('skillAuditContent', skillContent);
        window.open('/security-auditor', '_blank'); 
      } catch (error) {
        alert('Error: ' + error.message);
      }
    }

    function updateVoteWidget(widget, toolData) {
      if (!widget || !toolData) return;
      const upBtn = widget.querySelector('[data-vote="1"]');
      const downBtn = widget.querySelector('[data-vote="-1"]');
      const countNode = widget.querySelector('.vote-count');
      widget.dataset.rankScore = String(toolData.rankScore ?? 0);
      widget.dataset.viewerVote = String(toolData.viewerVote ?? 0);

      if (countNode) {
        countNode.textContent = toolData.displayCount || 'New';
      }
      if (upBtn) {
        upBtn.classList.toggle('is-active', Number(toolData.viewerVote) === 1);
      }
      if (downBtn) {
        downBtn.classList.toggle('is-active', Number(toolData.viewerVote) === -1);
      }
    }

    function setWidgetBusy(widget, busy) {
      widget.dataset.busy = busy ? '1' : '0';
      widget.querySelectorAll('.vote-btn').forEach((btn) => {
        btn.disabled = busy;
      });
    }

    function applySortMode(grid, mode) {
      const cards = [...grid.querySelectorAll('.skill-card[data-tool-id]')];
      cards.sort((a, b) => {
        if (mode === 'community') {
          const scoreDiff = Number(b.dataset.rankScore || 0) - Number(a.dataset.rankScore || 0);
          if (scoreDiff !== 0) return scoreDiff;
        }
        return Number(a.dataset.originalIndex || 0) - Number(b.dataset.originalIndex || 0);
      });
      cards.forEach((card) => grid.appendChild(card));
    }

    function bindSortToggle(toolbar, grid) {
      const buttons = toolbar.querySelectorAll('.sort-toggle-btn');
      const status = toolbar.querySelector('.sort-status');
      buttons.forEach((btn) => {
        btn.addEventListener('click', () => {
          const mode = btn.dataset.sortMode;
          buttons.forEach((b) => b.classList.toggle('is-active', b === btn));
          applySortMode(grid, mode);
          status.textContent = mode === 'community' ? 'Community ranking active' : 'Original order active';
        });
      });
    }

    async function fetchScores(categoryId, toolIds) {
      const params = new URLSearchParams({
        categoryId,
        toolIds: toolIds.join(',')
      });
      const response = await fetch('/api/v1/scores?' + params.toString(), {
        method: 'GET',
        credentials: 'same-origin'
      });
      if (!response.ok) {
        throw new Error('Unable to fetch vote scores');
      }
      return response.json();
    }

    async function submitVote(widget, voteValue) {
      const categoryId = widget.dataset.categoryId;
      const toolId = widget.dataset.toolId;
      setWidgetBusy(widget, true);
      try {
        const response = await fetch('/api/v1/vote', {
          method: 'POST',
          credentials: 'same-origin',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            categoryId,
            toolId,
            vote: voteValue
          })
        });
        const payload = await response.json().catch(() => ({}));
        if (!response.ok) {
          throw new Error(payload.error || 'Vote request failed');
        }
        if (payload.tool) {
          updateVoteWidget(widget, payload.tool);
          const card = widget.closest('.skill-card[data-tool-id]');
          if (card) {
            card.dataset.rankScore = String(payload.tool.rankScore ?? 0);
          }
        }
      } catch (error) {
        console.error(error);
      } finally {
        setWidgetBusy(widget, false);
      }
    }

    document.addEventListener('DOMContentLoaded', async () => {
      const widgets = [...document.querySelectorAll('.vote-widget[data-category-id][data-tool-id]')];
      if (widgets.length === 0) return;

      const grouped = new Map();
      widgets.forEach((widget) => {
        const key = widget.dataset.categoryId;
        if (!grouped.has(key)) grouped.set(key, new Map());
        grouped.get(key).set(widget.dataset.toolId, widget);
      });

      for (const [categoryId, widgetMap] of grouped.entries()) {
        const toolIds = [...widgetMap.keys()];
        try {
          const data = await fetchScores(categoryId, toolIds);
          const byTool = new Map((data.tools || []).map((tool) => [tool.toolId, tool]));
          for (const [toolId, widget] of widgetMap.entries()) {
            const toolData = byTool.get(toolId);
            if (toolData) {
              updateVoteWidget(widget, toolData);
              const card = widget.closest('.skill-card[data-tool-id]');
              if (card) {
                card.dataset.rankScore = String(toolData.rankScore ?? 0);
              }
            }
          }
        } catch (error) {
          console.error(error);
        }
      }

      widgets.forEach((widget) => {
        widget.querySelectorAll('.vote-btn').forEach((btn) => {
          btn.addEventListener('click', (event) => {
            event.preventDefault();
            event.stopPropagation();
            if (widget.dataset.busy === '1') return;
            const voteValue = Number(btn.dataset.vote);
            submitVote(widget, voteValue).then(() => {
              const grid = widget.closest('.skills-grid[data-category-id]');
              const toolbar = document.querySelector('.sort-toolbar[data-category-id="' + widget.dataset.categoryId + '"]');
              const communityBtn = toolbar ? toolbar.querySelector('.sort-toggle-btn[data-sort-mode="community"]') : null;
              if (grid && communityBtn && communityBtn.classList.contains('is-active')) {
                applySortMode(grid, 'community');
              }
            });
          });
        });
      });

      document.querySelectorAll('.skills-grid[data-category-id]').forEach((grid) => {
        const categoryId = grid.dataset.categoryId;
        const toolbar = document.querySelector('.sort-toolbar[data-category-id="' + categoryId + '"]');
        if (!toolbar) return;
        bindSortToggle(toolbar, grid);
        applySortMode(grid, 'community');
      });
    });
  </script>
</body>
</html>