<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="- **Skill 名称**: ppt-generator-pro">
  <title>nanobanana-ppt-skills - OpenClaw Directory</title>
  <link rel="canonical" href="https://moltdirectory.com/ai-llms/nanobanana-ppt-skills/">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🦞</text></svg>">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
  <script>
    // Apply saved theme before page renders to prevent flash
    (function() {
      const savedTheme = localStorage.getItem('theme') || 'dark';
      if (savedTheme === 'light') {
        document.documentElement.setAttribute('data-theme', 'light');
      }
    })();
  </script>
</head>
<body>
  <header class="header">
    <div class="header-inner">
      <a href="/" class="logo">

        <span class="logo-text">OpenClaw Directory</span>
      </a>
      <nav class="header-links">
        <a href="/start-here/" class="header-link">Start Here</a>
        <a href="/security-auditor" class="header-link">Security Auditor</a>
        <a href="https://github.com/neonone123/moltdirectory/issues/new?template=add-skill.yml" class="header-link" target="_blank" rel="noopener">Add Skill</a>
        <button class="theme-toggle" aria-label="Toggle theme" onclick="toggleTheme()">
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
        </button>
        <a href="https://www.reddit.com/r/OpenClawDirectory/" class="header-link" target="_blank" rel="noopener" aria-label="Community">
          <svg viewBox="0 0 16 16" fill="currentColor" width="28" height="28"><path d="M6.167 8a.83.83 0 0 0-.83.83c0 .459.372.84.83.831a.831.831 0 0 0 0-1.661m1.843 3.647c.315 0 1.403-.038 1.976-.611a.23.23 0 0 0 0-.306.213.213 0 0 0-.306 0c-.353.363-1.126.487-1.67.487-.545 0-1.308-.124-1.671-.487a.213.213 0 0 0-.306 0 .213.213 0 0 0 0 .306c.564.563 1.652.61 1.977.61zm.992-2.807c0 .458.373.83.831.83s.83-.381.83-.83a.831.831 0 0 0-1.66 0z"/><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.828-1.165c-.315 0-.602.124-.812.325-.801-.573-1.9-.945-3.121-.993l.534-2.501 1.738.372a.83.83 0 1 0 .83-.869.83.83 0 0 0-.744.468l-1.938-.41a.2.2 0 0 0-.153.028.2.2 0 0 0-.086.134l-.592 2.788c-1.24.038-2.358.41-3.17.992-.21-.2-.496-.324-.81-.324a1.163 1.163 0 0 0-.478 2.224q-.03.17-.029.353c0 1.795 2.091 3.256 4.669 3.256s4.668-1.451 4.668-3.256c0-.114-.01-.238-.029-.353.401-.181.688-.592.688-1.069 0-.65-.525-1.165-1.165-1.165"/></svg>
        </a>
      </nav>
    </div>
  </header>
  
          <section class="skill-page-header">
            <div class="skill-page-header-inner">
              <a href="/ai-llms/" class="back-link">← Back to AI & LLMs</a>
              <div class="skill-page-meta">
                <a href="/ai-llms/" class="skill-page-category">AI & LLMs</a>
                <span class="skill-page-author">by @itrocker</span>
              </div>
              <h1 class="skill-page-title">nanobanana-ppt-skills</h1>
              <p class="skill-page-desc">- **Skill 名称**: ppt-generator-pro</p>
              <div class="vote-widget skill-page-vote" data-category-id="ai-llms" data-tool-id="nanobanana-ppt-skills">
                <button type="button" class="vote-btn" data-vote="1" aria-label="Upvote nanobanana-ppt-skills">▲</button>
                <span class="vote-count">New</span>
                <button type="button" class="vote-btn" data-vote="-1" aria-label="Downvote nanobanana-ppt-skills">▼</button>
              </div>
            </div>
          </section>
          <div class="skill-page-body">
            <article class="skill-page-content">
              <div class="skill-source-wrapper">
                <div class="skill-source-header">
                  <div class="skill-source-title">Source Code</div>
                  <button class="copy-btn" onclick="copySkillContent(this)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                    Copy
                  </button>
                </div>
                <div class="markdown-content">
                  <h1>PPT Generator Pro - Claude Code Skill</h1>
<h2>📋 元数据</h2>
<ul>
<li><strong>Skill 名称</strong>: ppt-generator-pro</li>
<li><strong>版本</strong>: 2.0.0</li>
<li><strong>描述</strong>: 基于 AI 自动生成高质量 PPT 图片和视频，支持智能转场和交互式播放</li>
<li><strong>作者</strong>: 歸藏</li>
<li><strong>标签</strong>: ppt, presentation, video, ai, nano-banana, kling-ai, image-generation</li>
</ul>
<h2>✨ 功能特性</h2>
<h3>核心功能</h3>
<ul>
<li>🤖 <strong>智能文档分析</strong> - 自动提取核心要点，规划 PPT 内容结构</li>
<li>🎨 <strong>多风格支持</strong> - 内置渐变毛玻璃、矢量插画两种专业风格</li>
<li>🖼️ <strong>高质量图片</strong> - 使用 Nano Banana Pro 生成 16:9 高清 PPT</li>
<li>🎬 <strong>AI 转场视频</strong> - 可灵 AI 生成流畅的页面过渡动画</li>
<li>🎮 <strong>交互式播放器</strong> - 视频+图片混合播放，支持键盘导航</li>
<li>🎥 <strong>完整视频导出</strong> - FFmpeg 合成包含所有转场的完整 PPT 视频</li>
</ul>
<h3>新功能 (v2.0)</h3>
<ul>
<li>🔄 <strong>首页循环预览</strong> - 自动生成吸引眼球的循环动画</li>
<li>🎞️ <strong>智能转场</strong> - 自动生成页面间的过渡视频</li>
<li>🔧 <strong>参数统一</strong> - 自动统一所有视频分辨率和帧率</li>
</ul>
<h2>📦 系统要求</h2>
<h3>环境变量</h3>
<p><strong>必需：</strong></p>
<ul>
<li><code>GEMINI_API_KEY</code>: Google AI API 密钥（用于生成 PPT 图片）</li>
</ul>
<p><strong>可选（用于视频功能）：</strong></p>
<ul>
<li><code>KLING_ACCESS_KEY</code>: 可灵 AI Access Key</li>
<li><code>KLING_SECRET_KEY</code>: 可灵 AI Secret Key</li>
</ul>
<h3>Python 依赖</h3>
<pre><code class="language-bash">pip install google-genai pillow python-dotenv
</code></pre>
<h3>视频功能依赖</h3>
<pre><code class="language-bash"># macOS
brew install ffmpeg

# Ubuntu/Debian
sudo apt-get install ffmpeg
</code></pre>
<h2>🚀 使用方法</h2>
<h3>在 Claude Code 中调用</h3>
<pre><code class="language-bash">/ppt-generator-pro
</code></pre>
<p>或直接告诉 Claude：</p>
<pre><code>我想基于以下文档生成一个 5 页的 PPT，使用渐变毛玻璃风格。

[文档内容...]
</code></pre>
<h2>📝 Skill 执行流程</h2>
<h3>阶段 1: 收集用户输入</h3>
<h4>1.1 获取文档内容</h4>
<p><strong>选项 A: 文档路径</strong></p>
<pre><code>用户: 基于 my-document.md 生成 PPT
→ 使用 Read 工具读取文件内容
</code></pre>
<p><strong>选项 B: 直接文本</strong></p>
<pre><code>用户: 我想生成一个关于 AI 产品设计的 PPT
主要内容：
1. 现状分析
2. 设计原则
3. 案例研究
</code></pre>
<p><strong>选项 C: 主动询问</strong></p>
<pre><code>如果用户未提供内容，询问：
&quot;请提供文档路径或直接粘贴文档内容&quot;
</code></pre>
<h4>1.2 选择风格</h4>
<p>扫描 <code>styles/</code> 目录，列出可用风格：</p>
<pre><code class="language-python"># 自动检测风格文件
styles = [&#39;gradient-glass.md&#39;, &#39;vector-illustration.md&#39;]
</code></pre>
<p><strong>如果有多个风格，使用 AskUserQuestion：</strong></p>
<pre><code class="language-markdown">问题: 请选择 PPT 风格
选项:
- 渐变毛玻璃卡片风格（科技感、商务演示）
- 矢量插画风格（温暖、教育培训）
</code></pre>
<h4>1.3 选择页数范围</h4>
<p>使用 AskUserQuestion 询问：</p>
<pre><code class="language-markdown">问题: 希望生成多少页 PPT？
选项:
- 5 页（5 分钟演讲）
- 5-10 页（10-15 分钟演讲）
- 10-15 页（20-30 分钟演讲）
- 20-25 页（45-60 分钟演讲）
</code></pre>
<h4>1.4 选择分辨率</h4>
<pre><code class="language-markdown">问题: 选择图片分辨率
选项:
- 2K (2752x1536) - 推荐，快速生成
- 4K (5504x3072) - 高质量，适合打印
</code></pre>
<h4>1.5 是否生成视频（可选）</h4>
<p>如果配置了可灵 AI 密钥，询问：</p>
<pre><code class="language-markdown">问题: 是否生成转场视频？
选项:
- 仅图片（快速）
- 图片 + 转场视频（完整体验）
</code></pre>
<h3>阶段 2: 文档分析与内容规划</h3>
<h4>2.1 内容规划策略</h4>
<p>根据页数范围，智能规划每一页内容：</p>
<p><strong>5 页版本：</strong></p>
<ol>
<li>封面：标题 + 核心主题</li>
<li>要点 1：第一个核心观点</li>
<li>要点 2：第二个核心观点</li>
<li>要点 3：第三个核心观点</li>
<li>总结：核心结论或行动建议</li>
</ol>
<p><strong>5-10 页版本：</strong></p>
<ol>
<li>封面
2-3. 引言/背景
4-7. 核心内容（3-4 个关键观点）
8-9. 案例或数据支持</li>
<li>总结与行动建议</li>
</ol>
<p><strong>10-15 页版本：</strong></p>
<ol>
<li>封面
2-3. 引言/目录
4-6. 第一章节（3 页）
7-9. 第二章节（3 页）
10-12. 第三章节/案例研究
13-14. 数据可视化</li>
<li>总结与下一步</li>
</ol>
<p><strong>20-25 页版本：</strong></p>
<ol>
<li>封面</li>
<li>目录
3-4. 引言和背景
5-8. 第一部分（4 页）
9-12. 第二部分（4 页）
13-16. 第三部分（4 页）
17-19. 案例研究
20-22. 数据分析和洞察
23-24. 关键发现和建议</li>
<li>总结与致谢</li>
</ol>
<h4>2.2 生成 slides_plan.json</h4>
<p>创建 JSON 文件：</p>
<pre><code class="language-json">{
  &quot;title&quot;: &quot;文档标题&quot;,
  &quot;total_slides&quot;: 5,
  &quot;slides&quot;: [
    {
      &quot;slide_number&quot;: 1,
      &quot;page_type&quot;: &quot;cover&quot;,
      &quot;content&quot;: &quot;标题：AI 产品设计指南\n副标题：构建以用户为中心的智能体验&quot;
    },
    {
      &quot;slide_number&quot;: 2,
      &quot;page_type&quot;: &quot;content&quot;,
      &quot;content&quot;: &quot;核心原则\n- 简单直观\n- 快速响应\n- 透明可控&quot;
    },
    {
      &quot;slide_number&quot;: 3,
      &quot;page_type&quot;: &quot;content&quot;,
      &quot;content&quot;: &quot;设计流程\n1. 用户研究\n2. 原型设计\n3. 测试迭代&quot;
    },
    {
      &quot;slide_number&quot;: 4,
      &quot;page_type&quot;: &quot;data&quot;,
      &quot;content&quot;: &quot;用户满意度\n使用前：65%\n使用后：92%\n提升：+27%&quot;
    },
    {
      &quot;slide_number&quot;: 5,
      &quot;page_type&quot;: &quot;content&quot;,
      &quot;content&quot;: &quot;总结\n- 以用户为中心\n- 持续优化迭代\n- 数据驱动决策&quot;
    }
  ]
}
</code></pre>
<p><strong>重要：</strong> 将此文件保存到：</p>
<ul>
<li>独立使用：<code>./slides_plan.json</code></li>
<li>Skill 模式：<code>.claude/skills/ppt-generator/slides_plan.json</code></li>
</ul>
<h3>阶段 3: 生成 PPT 图片</h3>
<h4>3.1 确定工作目录</h4>
<p><strong>独立模式：</strong></p>
<pre><code class="language-bash">cd /path/to/ppt-generator
</code></pre>
<p><strong>Skill 模式：</strong></p>
<pre><code class="language-bash">cd ~/.claude/skills/ppt-generator
</code></pre>
<h4>3.2 执行生成命令</h4>
<pre><code class="language-bash">python generate_ppt.py \
  --plan slides_plan.json \
  --style styles/gradient-glass.md \
  --resolution 2K
</code></pre>
<p><strong>或使用 uv run（推荐）：</strong></p>
<pre><code class="language-bash">uv run python generate_ppt.py \
  --plan slides_plan.json \
  --style styles/gradient-glass.md \
  --resolution 2K
</code></pre>
<p><strong>参数说明：</strong></p>
<ul>
<li><code>--plan</code>: slides 规划 JSON 文件路径</li>
<li><code>--style</code>: 风格文件路径</li>
<li><code>--resolution</code>: 分辨率（2K 或 4K）</li>
<li><code>--template</code>: HTML 模板路径（可选）</li>
</ul>
<h4>3.3 监控生成进度</h4>
<p>脚本会输出进度信息：</p>
<pre><code>✅ 已加载环境变量: /path/to/.env
📊 开始生成 PPT 图片...
   总页数: 5
   分辨率: 2K (2752x1536)
   风格: 渐变毛玻璃卡片风格

🎨 生成第 1 页 (封面页)...
   提示词已生成
   调用 Nano Banana Pro API...
   ✅ 第 1 页生成成功 (32.5 秒)

🎨 生成第 2 页 (内容页)...
   ✅ 第 2 页生成成功 (28.3 秒)

...

✅ 所有页面生成完成！
📁 输出目录: outputs/20260112_143022/
</code></pre>
<h3>阶段 4: 生成转场提示词（视频模式需要）</h3>
<p><strong>这是 Skill 的核心优势</strong>：我（Claude Code）会分析生成的 PPT 图片，为每个转场生成精准的视频提示词。</p>
<h4>4.1 读取并分析 PPT 图片</h4>
<p>我会读取所有生成的图片：</p>
<pre><code class="language-python"># 自动读取输出目录中的所有图片
slides = [&#39;slide-01.png&#39;, &#39;slide-02.png&#39;, ...]
</code></pre>
<h4>4.2 分析图片差异并生成提示词</h4>
<p>对于每对相邻图片，我会：</p>
<ol>
<li><strong>视觉分析</strong>：理解两张图片的布局、元素、色彩差异</li>
<li><strong>生成预览提示词</strong>：为首页创建可循环的微动效描述</li>
<li><strong>生成转场提示词</strong>：详细描述如何从起始帧过渡到结束帧</li>
</ol>
<p><strong>示例输出：</strong></p>
<pre><code class="language-json">{
  &quot;preview&quot;: {
    &quot;slide_path&quot;: &quot;outputs/.../slide-01.png&quot;,
    &quot;prompt&quot;: &quot;画面保持封面的静态构图，中心的3D玻璃环缓慢旋转...&quot;
  },
  &quot;transitions&quot;: [
    {
      &quot;from_slide&quot;: 1,
      &quot;to_slide&quot;: 2,
      &quot;prompt&quot;: &quot;镜头从封面开始，玻璃环逐渐解构，分裂成透明碎片...&quot;
    }
  ]
}
</code></pre>
<h4>4.3 保存提示词文件</h4>
<p>我会将生成的提示词保存到：</p>
<pre><code>outputs/TIMESTAMP/transition_prompts.json
</code></pre>
<p><strong>关键优势：</strong></p>
<ul>
<li>✅ 不需要单独的 Claude API 密钥</li>
<li>✅ 提示词针对实际图片内容定制</li>
<li>✅ 考虑文字稳定性，避免视频模型弄模糊文字</li>
<li>✅ 符合渐变毛玻璃风格的视觉语言</li>
</ul>
<h3>阶段 5: 生成转场视频（可选）</h3>
<p>如果用户选择生成视频，使用阶段 4 生成的提示词文件：</p>
<pre><code class="language-bash">python generate_ppt_video.py \
  --slides-dir outputs/20260112_143022/images \
  --output-dir outputs/20260112_143022_video \
  --prompts-file outputs/20260112_143022/transition_prompts.json
</code></pre>
<p><strong>生成内容：</strong></p>
<ul>
<li>首页循环预览视频（<code>preview.mp4</code>）</li>
<li>页面间转场视频（<code>transition_01_to_02.mp4</code> 等）</li>
<li>交互式视频播放器（<code>video_index.html</code>）</li>
<li>完整视频（<code>full_ppt_video.mp4</code>）</li>
</ul>
<h3>阶段 6: 返回结果</h3>
<h4>6.1 仅图片模式</h4>
<pre><code>✅ PPT 生成成功！

📁 输出目录: outputs/20260112_143022/
🖼️ PPT 图片: outputs/20260112_143022/images/
🎬 播放网页: outputs/20260112_143022/index.html

打开播放网页:
open outputs/20260112_143022/index.html

播放器快捷键:
- ← → 键: 切换页面
- ↑ Home: 回到首页
- ↓ End: 跳到末页
- 空格: 暂停/继续自动播放
- ESC: 全屏切换
- H: 隐藏/显示控件
</code></pre>
<h4>5.2 视频模式</h4>
<pre><code>✅ PPT 视频生成成功！

📁 输出目录: outputs/20260112_143022_video/
🖼️ PPT 图片: outputs/20260112_143022/images/
🎬 转场视频: outputs/20260112_143022_video/videos/
🎮 交互式播放器: outputs/20260112_143022_video/video_index.html
🎥 完整视频: outputs/20260112_143022_video/full_ppt_video.mp4

打开交互式播放器:
open outputs/20260112_143022_video/video_index.html

播放逻辑:
1. 首页: 播放循环预览视频
2. 按右键 → 播放转场视频 → 显示目标页图片（2 秒）
3. 再按右键 → 播放下一个转场 → 显示下一页图片
4. 依此类推...

视频播放器快捷键:
- ← → 键: 上一页/下一页（含转场）
- 空格: 播放/暂停当前视频
- ESC: 全屏切换
- H: 隐藏/显示控件
</code></pre>
<h2>🔧 环境变量配置</h2>
<h3>.env 文件位置</h3>
<p>Skill 会按以下顺序查找 <code>.env</code> 文件：</p>
<ol>
<li><strong>脚本所在目录</strong> - <code>./ppt-generator/.env</code></li>
<li><strong>向上查找项目根目录</strong> - 直到找到包含 <code>.git</code> 或 <code>.env</code> 的目录</li>
<li><strong>Claude Skill 标准位置</strong> - <code>~/.claude/skills/ppt-generator/.env</code></li>
<li><strong>系统环境变量</strong> - 如果以上都未找到</li>
</ol>
<h3>.env 文件示例</h3>
<pre><code class="language-bash"># Google AI API 密钥（必需）
GEMINI_API_KEY=your_gemini_api_key_here

# 可灵 AI API 密钥（可选，用于视频功能）
KLING_ACCESS_KEY=your_kling_access_key_here
KLING_SECRET_KEY=your_kling_secret_key_here
</code></pre>
<h2>⚠️ 错误处理</h2>
<h3>常见错误及解决方案</h3>
<p><strong>1. API 密钥未设置</strong></p>
<pre><code>错误: ⚠️ 未找到 .env 文件，尝试使用系统环境变量
      未设置 GEMINI_API_KEY 环境变量

解决:
1. 创建 .env 文件
2. 添加 GEMINI_API_KEY=your_key_here
</code></pre>
<p><strong>2. Python 依赖缺失</strong></p>
<pre><code>错误: ModuleNotFoundError: No module named &#39;google.genai&#39;

解决: pip install google-genai pillow python-dotenv
</code></pre>
<p><strong>3. FFmpeg 未安装</strong></p>
<pre><code>错误: ❌ FFmpeg 不可用！

解决: brew install ffmpeg  # macOS
      sudo apt-get install ffmpeg  # Ubuntu
</code></pre>
<p><strong>4. API 调用失败</strong></p>
<pre><code>错误: API 调用超时或失败

解决:
1. 检查网络连接
2. 确认 API 密钥有效
3. 稍后重试
</code></pre>
<p><strong>5. 视频生成失败</strong></p>
<pre><code>错误: 可灵 AI 密钥未配置

解决:
1. 如果只需要图片，跳过视频生成步骤
2. 如果需要视频，配置 KLING_ACCESS_KEY 和 KLING_SECRET_KEY
</code></pre>
<h2>🎨 风格系统</h2>
<h3>已内置风格</h3>
<h4>1. 渐变毛玻璃卡片风格 (<code>gradient-glass.md</code>)</h4>
<p><strong>视觉特点：</strong></p>
<ul>
<li>Apple Keynote 极简主义</li>
<li>玻璃拟态效果</li>
<li>霓虹紫/电光蓝/珊瑚橙渐变</li>
<li>3D 玻璃物体 + 电影级光照</li>
</ul>
<p><strong>适用场景：</strong></p>
<ul>
<li>科技产品发布</li>
<li>商务演示</li>
<li>数据报告</li>
<li>企业品牌展示</li>
</ul>
<h4>2. 矢量插画风格 (<code>vector-illustration.md</code>)</h4>
<p><strong>视觉特点：</strong></p>
<ul>
<li>扁平化矢量设计</li>
<li>统一黑色轮廓线</li>
<li>复古柔和配色</li>
<li>几何化简化</li>
</ul>
<p><strong>适用场景：</strong></p>
<ul>
<li>教育培训</li>
<li>创意提案</li>
<li>儿童相关</li>
<li>温暖品牌故事</li>
</ul>
<h3>添加自定义风格</h3>
<ol>
<li>在 <code>styles/</code> 目录创建新的 <code>.md</code> 文件</li>
<li>按照现有风格格式编写</li>
<li>Skill 会自动识别并提供选择</li>
</ol>
<h2>📊 技术细节</h2>
<h3>API 配置</h3>
<p><strong>Nano Banana Pro（图片生成）：</strong></p>
<ul>
<li>模型：<code>gemini-3-pro-image-preview</code></li>
<li>比例：<code>16:9</code></li>
<li>响应模式：<code>IMAGE</code></li>
<li>分辨率：2K (2752x1536) 或 4K (5504x3072)</li>
</ul>
<p><strong>可灵 AI（视频生成）：</strong></p>
<ul>
<li>模式：专业模式（professional）</li>
<li>时长：5 秒</li>
<li>分辨率：1920x1080</li>
<li>帧率：24fps</li>
</ul>
<p><strong>FFmpeg（视频合成）：</strong></p>
<ul>
<li>编码：H.264</li>
<li>质量：CRF 23</li>
<li>帧率：24fps（统一）</li>
<li>分辨率：1920x1080（统一）</li>
</ul>
<h3>性能指标</h3>
<p><strong>生成速度：</strong></p>
<ul>
<li>PPT 图片：~30 秒/页（2K）| ~60 秒/页（4K）</li>
<li>转场视频：~30-60 秒/段</li>
<li>视频合成：~5-10 秒</li>
</ul>
<p><strong>文件大小：</strong></p>
<ul>
<li>PPT 图片：~2.5MB/页（2K）| ~8MB/页（4K）</li>
<li>转场视频：~3-5MB/段（1080p，5 秒）</li>
<li>完整视频：~12-20MB（5 页 PPT + 转场）</li>
</ul>
<h2>📁 文件组织</h2>
<h3>输出目录结构</h3>
<p><strong>仅图片模式：</strong></p>
<pre><code>outputs/20260112_143022/
├── images/
│   ├── slide-01.png
│   ├── slide-02.png
│   └── ...
├── index.html          # 图片播放器
└── prompts.json        # 提示词记录
</code></pre>
<p><strong>视频模式：</strong></p>
<pre><code>outputs/20260112_143022_video/
├── videos/
│   ├── preview.mp4              # 首页循环预览
│   ├── transition_01_to_02.mp4
│   ├── transition_02_to_03.mp4
│   └── ...
├── video_index.html             # 交互式播放器
└── full_ppt_video.mp4           # 完整视频
</code></pre>
<h2>🎯 最佳实践</h2>
<ol>
<li><strong>文档质量</strong>：输入文档内容越清晰结构化，生成的 PPT 质量越高</li>
<li><strong>页数选择</strong>：根据文档长度和演示场景合理选择页数</li>
<li><strong>分辨率选择</strong>：日常使用推荐 2K，重要展示场合可选 4K</li>
<li><strong>视频功能</strong>：首次使用建议先尝试仅图片模式，熟悉后再使用视频功能</li>
<li><strong>提示词调整</strong>：查看 <code>prompts.json</code> 了解生成逻辑，可手动调整后重新生成</li>
</ol>
<h2>📝 使用示例</h2>
<h3>示例 1: 快速生成</h3>
<p><strong>用户输入：</strong></p>
<pre><code>我需要基于这份会议纪要生成一个 5 页的 PPT，使用矢量插画风格。

会议主题：Q1 产品路线图规划
参与人：产品团队

讨论内容：
1. 用户反馈汇总
2. 新功能优先级
3. 技术可行性评估
4. Q1 里程碑
5. 下一步行动项
</code></pre>
<p><strong>Skill 执行：</strong></p>
<ol>
<li>收集输入（已提供内容）</li>
<li>确认风格（矢量插画）</li>
<li>确认页数（5 页）</li>
<li>确认分辨率（询问用户）</li>
<li>生成 slides_plan.json</li>
<li>执行生成命令</li>
<li>返回结果</li>
</ol>
<h3>示例 2: 完整流程</h3>
<p><strong>用户输入：</strong></p>
<pre><code>基于 AI-Product-Design.md 文档，生成一个 15 页的 PPT，使用渐变毛玻璃风格，需要转场视频。
</code></pre>
<p><strong>Skill 执行：</strong></p>
<ol>
<li>读取文档内容</li>
<li>确认风格（渐变毛玻璃）</li>
<li>确认页数（15 页）</li>
<li>确认分辨率（询问用户）</li>
<li>确认生成视频（是）</li>
<li>分析文档，规划 15 页内容</li>
<li>生成 slides_plan.json</li>
<li>生成 PPT 图片</li>
<li>生成转场视频</li>
<li>合成完整视频</li>
<li>返回所有结果</li>
</ol>
<h2>🔄 更新日志</h2>
<h3>v2.0.0 (2026-01-12)</h3>
<ul>
<li>🎬 <strong>新增视频功能</strong><ul>
<li>可灵 AI 转场视频生成</li>
<li>交互式视频播放器</li>
<li>FFmpeg 完整视频合成</li>
<li>首页循环预览视频</li>
</ul>
</li>
<li>🔧 <strong>优化视频合成</strong><ul>
<li>自动统一分辨率和帧率</li>
<li>修复视频拼接兼容性问题</li>
<li>静态图片展示时间改为 2 秒</li>
</ul>
</li>
<li>🔑 <strong>改进环境变量</strong><ul>
<li>智能查找 .env 文件</li>
<li>支持多种部署模式</li>
<li>自动向上查找项目根目录</li>
</ul>
</li>
<li>📚 <strong>文档完善</strong><ul>
<li>重命名为 SKILL.md（符合官方规范）</li>
<li>更新所有路径和命令</li>
<li>添加视频功能使用指南</li>
</ul>
</li>
</ul>
<h3>v1.0.0 (2026-01-09)</h3>
<ul>
<li>✨ 首次发布</li>
<li>🎨 内置 2 种专业风格</li>
<li>🖼️ 支持 2K/4K 分辨率</li>
<li>🎬 HTML5 图片播放器</li>
<li>📊 智能文档分析</li>
</ul>
<h2>📄 许可证</h2>
<p>MIT License</p>
<h2>📞 技术支持</h2>
<ul>
<li>项目架构：参见 <code>ARCHITECTURE.md</code></li>
<li>API 管理：参见 <code>API_MANAGEMENT.md</code></li>
<li>环境配置：参见 <code>ENV_SETUP.md</code></li>
<li>安全说明：参见 <code>SECURITY.md</code></li>
<li>完整文档：参见 <code>README.md</code></li>
</ul>

                </div>
              </div>
            </article>
            <aside class="skill-page-sidebar">
              <div class="sidebar-card">
                <div class="sidebar-title">Actions</div>
                <a href="https://github.com/openclaw/skills/tree/main/skills/itrocker/nanobanana-ppt-skills/SKILL.md" target="_blank" rel="noopener" class="sidebar-btn sidebar-btn-primary">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/></svg>
                  View on GitHub
                </a>
                <a href="https://clawdhub.com/itrocker/nanobanana-ppt-skills" target="_blank" rel="noopener" class="sidebar-btn sidebar-btn-clawdhub">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/><line x1="2" y1="12" x2="22" y2="12"/></svg>
                  View on ClawdHub
                </a>
                <a href="https://raw.githubusercontent.com/openclaw/skills/main/skills/itrocker/nanobanana-ppt-skills/SKILL.md" download="SKILL.md" class="sidebar-btn sidebar-btn-secondary">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                  Download SKILL.md
                </a>
                <button onclick="sendToSecurityAuditor()" class="sidebar-btn sidebar-btn-security">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                  Security Check
                </button>
              </div>
              <div class="sidebar-card">
                <div class="sidebar-title">Details</div>
                <div class="sidebar-info">
                  <div class="sidebar-info-item">
                    <span class="sidebar-info-label">Author</span>
                    <span class="sidebar-info-value">@itrocker</span>
                  </div>
                  <div class="sidebar-info-item">
                    <span class="sidebar-info-label">Category</span>
                    <span class="sidebar-info-value">AI & LLMs</span>
                  </div>
                </div>
              </div>
            </aside>
          </div>
        
  <footer class="footer">
    <div class="footer-inner">
      <p class="footer-text" style="margin-bottom: 8px;"><a href="https://github.com/neonone123/moltdirectory" target="_blank" rel="noopener" style="color: var(--accent); text-decoration: none;">View on GitHub</a></p>
      <p class="footer-text" style="opacity: 0.6; font-size: 13px;">OpenClawDirectory.com is a community-run project and is not affiliated with the official OpenClaw team or Peter Steinberger. We are just fans of the lobster.</p>
    </div>
  </footer>
  <script>
    function toggleTheme() {
      const html = document.documentElement;
      const currentTheme = html.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      if (newTheme === 'light') {
        html.setAttribute('data-theme', 'light');
      } else {
        html.removeAttribute('data-theme');
      }
      localStorage.setItem('theme', newTheme);
    }
    
    function copySkillContent(btn) {
      const wrapper = btn.closest('.skill-source-wrapper');
      const content = wrapper.querySelector('.markdown-content');
      if (content) {
        const text = content.innerText || content.textContent;
        navigator.clipboard.writeText(text).then(() => {
          btn.classList.add('copied');
          btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg> Copied!';
          setTimeout(() => {
            btn.classList.remove('copied');
            btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copy';
          }, 2000);
        });
      }
    }

    async function sendToSecurityAuditor() {
      try {
        const contentElement = document.querySelector('.markdown-content');
        if (!contentElement) throw new Error('Could not find markdown content');
        const skillContent = contentElement.innerText || contentElement.textContent;
        localStorage.setItem('skillAuditContent', skillContent);
        window.open('/security-auditor', '_blank'); 
      } catch (error) {
        alert('Error: ' + error.message);
      }
    }

    function updateVoteWidget(widget, toolData) {
      if (!widget || !toolData) return;
      const upBtn = widget.querySelector('[data-vote="1"]');
      const downBtn = widget.querySelector('[data-vote="-1"]');
      const countNode = widget.querySelector('.vote-count');
      widget.dataset.rankScore = String(toolData.rankScore ?? 0);
      widget.dataset.viewerVote = String(toolData.viewerVote ?? 0);

      if (countNode) {
        countNode.textContent = toolData.displayCount || 'New';
      }
      if (upBtn) {
        upBtn.classList.toggle('is-active', Number(toolData.viewerVote) === 1);
      }
      if (downBtn) {
        downBtn.classList.toggle('is-active', Number(toolData.viewerVote) === -1);
      }
    }

    function setWidgetBusy(widget, busy) {
      widget.dataset.busy = busy ? '1' : '0';
      widget.querySelectorAll('.vote-btn').forEach((btn) => {
        btn.disabled = busy;
      });
    }

    function applySortMode(grid, mode) {
      const cards = [...grid.querySelectorAll('.skill-card[data-tool-id]')];
      cards.sort((a, b) => {
        if (mode === 'community') {
          const scoreDiff = Number(b.dataset.rankScore || 0) - Number(a.dataset.rankScore || 0);
          if (scoreDiff !== 0) return scoreDiff;
        }
        return Number(a.dataset.originalIndex || 0) - Number(b.dataset.originalIndex || 0);
      });
      cards.forEach((card) => grid.appendChild(card));
    }

    function bindSortToggle(toolbar, grid) {
      const buttons = toolbar.querySelectorAll('.sort-toggle-btn');
      const status = toolbar.querySelector('.sort-status');
      buttons.forEach((btn) => {
        btn.addEventListener('click', () => {
          const mode = btn.dataset.sortMode;
          buttons.forEach((b) => b.classList.toggle('is-active', b === btn));
          applySortMode(grid, mode);
          status.textContent = mode === 'community' ? 'Community ranking active' : 'Original order active';
        });
      });
    }

    async function fetchScores(categoryId, toolIds) {
      const params = new URLSearchParams({
        categoryId,
        toolIds: toolIds.join(',')
      });
      const response = await fetch('/api/v1/scores?' + params.toString(), {
        method: 'GET',
        credentials: 'same-origin'
      });
      if (!response.ok) {
        throw new Error('Unable to fetch vote scores');
      }
      return response.json();
    }

    async function submitVote(widget, voteValue) {
      const categoryId = widget.dataset.categoryId;
      const toolId = widget.dataset.toolId;
      setWidgetBusy(widget, true);
      try {
        const response = await fetch('/api/v1/vote', {
          method: 'POST',
          credentials: 'same-origin',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            categoryId,
            toolId,
            vote: voteValue
          })
        });
        const payload = await response.json().catch(() => ({}));
        if (!response.ok) {
          throw new Error(payload.error || 'Vote request failed');
        }
        if (payload.tool) {
          updateVoteWidget(widget, payload.tool);
          const card = widget.closest('.skill-card[data-tool-id]');
          if (card) {
            card.dataset.rankScore = String(payload.tool.rankScore ?? 0);
          }
        }
      } catch (error) {
        console.error(error);
      } finally {
        setWidgetBusy(widget, false);
      }
    }

    document.addEventListener('DOMContentLoaded', async () => {
      const widgets = [...document.querySelectorAll('.vote-widget[data-category-id][data-tool-id]')];
      if (widgets.length === 0) return;

      const grouped = new Map();
      widgets.forEach((widget) => {
        const key = widget.dataset.categoryId;
        if (!grouped.has(key)) grouped.set(key, new Map());
        grouped.get(key).set(widget.dataset.toolId, widget);
      });

      for (const [categoryId, widgetMap] of grouped.entries()) {
        const toolIds = [...widgetMap.keys()];
        try {
          const data = await fetchScores(categoryId, toolIds);
          const byTool = new Map((data.tools || []).map((tool) => [tool.toolId, tool]));
          for (const [toolId, widget] of widgetMap.entries()) {
            const toolData = byTool.get(toolId);
            if (toolData) {
              updateVoteWidget(widget, toolData);
              const card = widget.closest('.skill-card[data-tool-id]');
              if (card) {
                card.dataset.rankScore = String(toolData.rankScore ?? 0);
              }
            }
          }
        } catch (error) {
          console.error(error);
        }
      }

      widgets.forEach((widget) => {
        widget.querySelectorAll('.vote-btn').forEach((btn) => {
          btn.addEventListener('click', (event) => {
            event.preventDefault();
            event.stopPropagation();
            if (widget.dataset.busy === '1') return;
            const voteValue = Number(btn.dataset.vote);
            submitVote(widget, voteValue).then(() => {
              const grid = widget.closest('.skills-grid[data-category-id]');
              const toolbar = document.querySelector('.sort-toolbar[data-category-id="' + widget.dataset.categoryId + '"]');
              const communityBtn = toolbar ? toolbar.querySelector('.sort-toggle-btn[data-sort-mode="community"]') : null;
              if (grid && communityBtn && communityBtn.classList.contains('is-active')) {
                applySortMode(grid, 'community');
              }
            });
          });
        });
      });

      document.querySelectorAll('.skills-grid[data-category-id]').forEach((grid) => {
        const categoryId = grid.dataset.categoryId;
        const toolbar = document.querySelector('.sort-toolbar[data-category-id="' + categoryId + '"]');
        if (!toolbar) return;
        bindSortToggle(toolbar, grid);
        applySortMode(grid, 'community');
      });
    });
  </script>
</body>
</html>