<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Expertise-aware model router with semantic domain scoring">
  <title>smart-router - OpenClaw Directory</title>
  <link rel="canonical" href="https://moltdirectory.com/web-frontend-development/smart-router/">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¦</text></svg>">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
  <script>
    // Apply saved theme before page renders to prevent flash
    (function() {
      const savedTheme = localStorage.getItem('theme') || 'dark';
      if (savedTheme === 'light') {
        document.documentElement.setAttribute('data-theme', 'light');
      }
    })();
  </script>
</head>
<body>
  <header class="header">
    <div class="header-inner">
      <a href="/" class="logo">

        <span class="logo-text">OpenClaw Directory</span>
      </a>
      <nav class="header-links">
        <a href="/start-here/" class="header-link">Start Here</a>
        <a href="/security-auditor" class="header-link">Security Auditor</a>
        <a href="https://github.com/neonone123/moltdirectory/issues/new?template=add-skill.yml" class="header-link" target="_blank" rel="noopener">Add Skill</a>
        <button class="theme-toggle" aria-label="Toggle theme" onclick="toggleTheme()">
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
        </button>
        <a href="https://www.reddit.com/r/OpenClawDirectory/" class="header-link" target="_blank" rel="noopener" aria-label="Community">
          <svg viewBox="0 0 16 16" fill="currentColor" width="28" height="28"><path d="M6.167 8a.83.83 0 0 0-.83.83c0 .459.372.84.83.831a.831.831 0 0 0 0-1.661m1.843 3.647c.315 0 1.403-.038 1.976-.611a.23.23 0 0 0 0-.306.213.213 0 0 0-.306 0c-.353.363-1.126.487-1.67.487-.545 0-1.308-.124-1.671-.487a.213.213 0 0 0-.306 0 .213.213 0 0 0 0 .306c.564.563 1.652.61 1.977.61zm.992-2.807c0 .458.373.83.831.83s.83-.381.83-.83a.831.831 0 0 0-1.66 0z"/><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.828-1.165c-.315 0-.602.124-.812.325-.801-.573-1.9-.945-3.121-.993l.534-2.501 1.738.372a.83.83 0 1 0 .83-.869.83.83 0 0 0-.744.468l-1.938-.41a.2.2 0 0 0-.153.028.2.2 0 0 0-.086.134l-.592 2.788c-1.24.038-2.358.41-3.17.992-.21-.2-.496-.324-.81-.324a1.163 1.163 0 0 0-.478 2.224q-.03.17-.029.353c0 1.795 2.091 3.256 4.669 3.256s4.668-1.451 4.668-3.256c0-.114-.01-.238-.029-.353.401-.181.688-.592.688-1.069 0-.65-.525-1.165-1.165-1.165"/></svg>
        </a>
      </nav>
    </div>
  </header>
  
          <section class="skill-page-header">
            <div class="skill-page-header-inner">
              <a href="/web-frontend-development/" class="back-link">â† Back to Web & Frontend Development</a>
              <div class="skill-page-meta">
                <a href="/web-frontend-development/" class="skill-page-category">Web & Frontend Development</a>
                <span class="skill-page-author">by @c0nspic0us7urk3r</span>
              </div>
              <h1 class="skill-page-title">smart-router</h1>
              <p class="skill-page-desc">Expertise-aware model router with semantic domain scoring</p>
            </div>
          </section>
          <div class="skill-page-body">
            <article class="skill-page-content">
              <div class="skill-source-wrapper">
                <div class="skill-source-header">
                  <div class="skill-source-title">Source Code</div>
                  <button class="copy-btn" onclick="copySkillContent(this)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                    Copy
                  </button>
                </div>
                <div class="markdown-content">
                  <h1>A.I. Smart-Router</h1>
<p>Intelligently route requests to the optimal AI model using tiered classification with automatic fallback handling and cost optimization.</p>
<h2>How It Works (Silent by Default)</h2>
<p>The router operates transparentlyâ€”users send messages normally and get responses from the best model for their task. No special commands needed.</p>
<p><strong>Optional visibility</strong>: Include <code>[show routing]</code> in any message to see the routing decision.</p>
<h2>Tiered Classification System</h2>
<p>The router uses a three-tier decision process:</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TIER 1: INTENT DETECTION                      â”‚
â”‚  Classify the primary purpose of the request                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CODE        â”‚ ANALYSIS    â”‚ CREATIVE   â”‚ REALTIME  â”‚ GENERAL   â”‚
â”‚  write/debug â”‚ research    â”‚ writing    â”‚ news/live â”‚ Q&amp;A/chat  â”‚
â”‚  refactor    â”‚ explain     â”‚ stories    â”‚ X/Twitter â”‚ translate â”‚
â”‚  review      â”‚ compare     â”‚ brainstorm â”‚ prices    â”‚ summarize â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
       â”‚              â”‚            â”‚            â”‚           â”‚
       â–¼              â–¼            â–¼            â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  TIER 2: COMPLEXITY ESTIMATION                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  SIMPLE (Tier $)        â”‚ MEDIUM (Tier $$)    â”‚ COMPLEX (Tier $$$)â”‚
â”‚  â€¢ One-step task        â”‚ â€¢ Multi-step task   â”‚ â€¢ Deep reasoning  â”‚
â”‚  â€¢ Short response OK    â”‚ â€¢ Some nuance       â”‚ â€¢ Extensive outputâ”‚
â”‚  â€¢ Factual lookup       â”‚ â€¢ Moderate context  â”‚ â€¢ Critical task   â”‚
â”‚  â†’ Haiku/Flash          â”‚ â†’ Sonnet/Grok/GPT   â”‚ â†’ Opus/GPT-5      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                TIER 3: SPECIAL CASE OVERRIDES                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CONDITION                           â”‚ OVERRIDE TO              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  Context &gt;100K tokens                â”‚ â†’ Gemini Pro (1M ctx)    â”‚
â”‚  Context &gt;500K tokens                â”‚ â†’ Gemini Pro ONLY        â”‚
â”‚  Needs real-time data                â”‚ â†’ Grok (regardless)      â”‚
â”‚  Image/vision input                  â”‚ â†’ Opus or Gemini Pro     â”‚
â”‚  User explicit override              â”‚ â†’ Requested model        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2>Intent Detection Patterns</h2>
<h3>CODE Intent</h3>
<ul>
<li>Keywords: write, code, debug, fix, refactor, implement, function, class, script, API, bug, error, compile, test, PR, commit</li>
<li>File extensions mentioned: .py, .js, .ts, .go, .rs, .java, etc.</li>
<li>Code blocks in input</li>
</ul>
<h3>ANALYSIS Intent</h3>
<ul>
<li>Keywords: analyze, explain, compare, research, understand, why, how does, evaluate, assess, review, investigate, examine</li>
<li>Long-form questions</li>
<li>&quot;Help me understand...&quot;</li>
</ul>
<h3>CREATIVE Intent</h3>
<ul>
<li>Keywords: write (story/poem/essay), create, brainstorm, imagine, design, draft, compose</li>
<li>Fiction/narrative requests</li>
<li>Marketing/copy requests</li>
</ul>
<h3>REALTIME Intent</h3>
<ul>
<li>Keywords: now, today, current, latest, trending, news, happening, live, price, score, weather</li>
<li>X/Twitter mentions</li>
<li>Stock/crypto tickers</li>
<li>Sports scores</li>
</ul>
<h3>GENERAL Intent (Default)</h3>
<ul>
<li>Simple Q&amp;A</li>
<li>Translations</li>
<li>Summaries</li>
<li>Conversational</li>
</ul>
<h3>MIXED Intent (Multiple Intents Detected)</h3>
<p>When a request contains multiple clear intents (e.g., &quot;Write code to analyze this data and explain it creatively&quot;):</p>
<ol>
<li><strong>Identify primary intent</strong> â€” What&#39;s the main deliverable?</li>
<li><strong>Route to highest-capability model</strong> â€” Mixed tasks need versatility</li>
<li><strong>Default to COMPLEX complexity</strong> â€” Multi-intent = multi-step</li>
</ol>
<p><strong>Examples:</strong></p>
<ul>
<li>&quot;Write code AND explain how it works&quot; â†’ CODE (primary) + ANALYSIS â†’ Route to Opus</li>
<li>&quot;Summarize this AND what&#39;s the latest news on it&quot; â†’ REALTIME takes precedence â†’ Grok</li>
<li>&quot;Creative story using real current events&quot; â†’ REALTIME + CREATIVE â†’ Grok (real-time wins)</li>
</ul>
<h2>Language Handling</h2>
<p><strong>Non-English requests</strong> are handled normally â€” all supported models have multilingual capabilities:</p>
<table>
<thead>
<tr>
<th>Model</th>
<th>Non-English Support</th>
</tr>
</thead>
<tbody><tr>
<td>Opus/Sonnet/Haiku</td>
<td>Excellent (100+ languages)</td>
</tr>
<tr>
<td>GPT-5</td>
<td>Excellent (100+ languages)</td>
</tr>
<tr>
<td>Gemini Pro/Flash</td>
<td>Excellent (100+ languages)</td>
</tr>
<tr>
<td>Grok</td>
<td>Good (major languages)</td>
</tr>
</tbody></table>
<p><strong>Intent detection still works</strong> because:</p>
<ul>
<li>Keyword patterns include common non-English equivalents</li>
<li>Code intent detected by file extensions, code blocks (language-agnostic)</li>
<li>Complexity estimated by query length (works across languages)</li>
</ul>
<p><strong>Edge case:</strong> If intent unclear due to language, default to GENERAL intent with MEDIUM complexity.</p>
<h2>Complexity Signals</h2>
<h3>Simple Complexity ($)</h3>
<ul>
<li>Short query (&lt;50 words)</li>
<li>Single question mark</li>
<li>&quot;Quick question&quot;, &quot;Just tell me&quot;, &quot;Briefly&quot;</li>
<li>Yes/no format</li>
<li>Unit conversions, definitions</li>
</ul>
<h3>Medium Complexity ($$)</h3>
<ul>
<li>Moderate query (50-200 words)</li>
<li>Multiple aspects to address</li>
<li>&quot;Explain&quot;, &quot;Describe&quot;, &quot;Compare&quot;</li>
<li>Some context provided</li>
</ul>
<h3>Complex Complexity ($$$)</h3>
<ul>
<li>Long query (&gt;200 words) or complex task</li>
<li>&quot;Step by step&quot;, &quot;Thoroughly&quot;, &quot;In detail&quot;</li>
<li>Multi-part questions</li>
<li>Critical/important qualifier</li>
<li>Research, analysis, or creative work</li>
</ul>
<h2>Routing Matrix</h2>
<table>
<thead>
<tr>
<th>Intent</th>
<th>Simple</th>
<th>Medium</th>
<th>Complex</th>
</tr>
</thead>
<tbody><tr>
<td><strong>CODE</strong></td>
<td>Sonnet</td>
<td>Opus</td>
<td>Opus</td>
</tr>
<tr>
<td><strong>ANALYSIS</strong></td>
<td>Flash</td>
<td>GPT-5</td>
<td>Opus</td>
</tr>
<tr>
<td><strong>CREATIVE</strong></td>
<td>Sonnet</td>
<td>Opus</td>
<td>Opus</td>
</tr>
<tr>
<td><strong>REALTIME</strong></td>
<td>Grok</td>
<td>Grok</td>
<td>Grok-3</td>
</tr>
<tr>
<td><strong>GENERAL</strong></td>
<td>Flash</td>
<td>Sonnet</td>
<td>Opus</td>
</tr>
</tbody></table>
<h2>Token Exhaustion &amp; Automatic Model Switching</h2>
<p>When a model becomes unavailable mid-session (token quota exhausted, rate limit hit, API error), the router automatically switches to the next best available model and <strong>notifies the user</strong>.</p>
<h3>Notification Format</h3>
<p>When a model switch occurs due to exhaustion, the user receives a notification:</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ MODEL SWITCH NOTICE                                         â”‚
â”‚                                                                  â”‚
â”‚  Your request could not be completed on claude-opus-4-5         â”‚
â”‚  (reason: token quota exhausted).                               â”‚
â”‚                                                                  â”‚
â”‚  âœ… Request completed using: anthropic/claude-sonnet-4-5        â”‚
â”‚                                                                  â”‚
â”‚  The response below was generated by the fallback model.        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3>Switch Reasons</h3>
<table>
<thead>
<tr>
<th>Reason</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>token quota exhausted</code></td>
<td>Daily/monthly token limit reached</td>
</tr>
<tr>
<td><code>rate limit exceeded</code></td>
<td>Too many requests per minute</td>
</tr>
<tr>
<td><code>context window exceeded</code></td>
<td>Input too large for model</td>
</tr>
<tr>
<td><code>API timeout</code></td>
<td>Model took too long to respond</td>
</tr>
<tr>
<td><code>API error</code></td>
<td>Provider returned an error</td>
</tr>
<tr>
<td><code>model unavailable</code></td>
<td>Model temporarily offline</td>
</tr>
</tbody></table>
<h3>Implementation</h3>
<pre><code class="language-python">def execute_with_fallback(primary_model: str, fallback_chain: list[str], request: str) -&gt; Response:
    &quot;&quot;&quot;
    Execute request with automatic fallback and user notification.
    &quot;&quot;&quot;
    attempted_models = []
    switch_reason = None
    
    # Try primary model first
    models_to_try = [primary_model] + fallback_chain
    
    for model in models_to_try:
        try:
            response = call_model(model, request)
            
            # If we switched models, prepend notification
            if attempted_models:
                notification = build_switch_notification(
                    failed_model=attempted_models[0],
                    reason=switch_reason,
                    success_model=model
                )
                return Response(
                    content=notification + &quot;\n\n---\n\n&quot; + response.content,
                    model_used=model,
                    switched=True
                )
            
            return Response(content=response.content, model_used=model, switched=False)
            
        except TokenQuotaExhausted:
            attempted_models.append(model)
            switch_reason = &quot;token quota exhausted&quot;
            log_fallback(model, switch_reason)
            continue
            
        except RateLimitExceeded:
            attempted_models.append(model)
            switch_reason = &quot;rate limit exceeded&quot;
            log_fallback(model, switch_reason)
            continue
            
        except ContextWindowExceeded:
            attempted_models.append(model)
            switch_reason = &quot;context window exceeded&quot;
            log_fallback(model, switch_reason)
            continue
            
        except APITimeout:
            attempted_models.append(model)
            switch_reason = &quot;API timeout&quot;
            log_fallback(model, switch_reason)
            continue
            
        except APIError as e:
            attempted_models.append(model)
            switch_reason = f&quot;API error: {e.code}&quot;
            log_fallback(model, switch_reason)
            continue
    
    # All models exhausted
    return build_exhaustion_error(attempted_models)


def build_switch_notification(failed_model: str, reason: str, success_model: str) -&gt; str:
    &quot;&quot;&quot;Build user-facing notification when model switch occurs.&quot;&quot;&quot;
    return f&quot;&quot;&quot;âš ï¸ **MODEL SWITCH NOTICE**

Your request could not be completed on `{failed_model}` (reason: {reason}).

âœ… **Request completed using:** `{success_model}`

The response below was generated by the fallback model.&quot;&quot;&quot;


def build_exhaustion_error(attempted_models: list[str]) -&gt; Response:
    &quot;&quot;&quot;Build error when all models are exhausted.&quot;&quot;&quot;
    models_tried = &quot;, &quot;.join(attempted_models)
    return Response(
        content=f&quot;&quot;&quot;âŒ **REQUEST FAILED**

Unable to complete your request. All available models have been exhausted.

**Models attempted:** {models_tried}

**What you can do:**
1. **Wait** â€” Token quotas typically reset hourly or daily
2. **Simplify** â€” Try a shorter or simpler request
3. **Check status** â€” Run `/router status` to see model availability

If this persists, your human may need to check API quotas or add additional providers.&quot;&quot;&quot;,
        model_used=None,
        switched=False,
        failed=True
    )
</code></pre>
<h3>Fallback Priority for Token Exhaustion</h3>
<p>When a model is exhausted, the router selects the next best model for the <strong>same task type</strong>:</p>
<table>
<thead>
<tr>
<th>Original Model</th>
<th>Fallback Priority (same capability)</th>
</tr>
</thead>
<tbody><tr>
<td>Opus</td>
<td>Sonnet â†’ GPT-5 â†’ Grok-3 â†’ Gemini Pro</td>
</tr>
<tr>
<td>Sonnet</td>
<td>GPT-5 â†’ Grok-3 â†’ Opus â†’ Haiku</td>
</tr>
<tr>
<td>GPT-5</td>
<td>Sonnet â†’ Opus â†’ Grok-3 â†’ Gemini Pro</td>
</tr>
<tr>
<td>Gemini Pro</td>
<td>Flash â†’ GPT-5 â†’ Opus â†’ Sonnet</td>
</tr>
<tr>
<td>Grok-2/3</td>
<td>(warn: no real-time fallback available)</td>
</tr>
</tbody></table>
<h3>User Acknowledgment</h3>
<p>After a model switch, the agent should note in the response that:</p>
<ol>
<li>The original model was unavailable</li>
<li>Which model actually completed the request</li>
<li>The response quality may differ from the original model&#39;s typical output</li>
</ol>
<p>This ensures transparency and sets appropriate expectations.</p>
<h3>Streaming Responses with Fallback</h3>
<p>When using streaming responses, fallback handling requires special consideration:</p>
<pre><code class="language-python">async def execute_with_streaming_fallback(primary_model: str, fallback_chain: list[str], request: str):
    &quot;&quot;&quot;
    Handle streaming responses with mid-stream fallback.
    
    If a model fails DURING streaming (not before), the partial response is lost.
    Strategy: Don&#39;t start streaming until first chunk received successfully.
    &quot;&quot;&quot;
    models_to_try = [primary_model] + fallback_chain
    
    for model in models_to_try:
        try:
            # Test with non-streaming ping first (optional, adds latency)
            # await test_model_availability(model)
            
            # Start streaming
            stream = await call_model_streaming(model, request)
            first_chunk = await stream.get_first_chunk(timeout=10_000)  # 10s timeout for first chunk
            
            # If we got here, model is responding â€” continue streaming
            yield first_chunk
            async for chunk in stream:
                yield chunk
            return  # Success
            
        except (FirstChunkTimeout, StreamError) as e:
            log_fallback(model, str(e))
            continue  # Try next model
    
    # All models failed
    yield build_exhaustion_error(models_to_try)
</code></pre>
<p><strong>Key insight:</strong> Wait for the first chunk before committing to a model. If the first chunk times out, fall back before any partial response is shown to the user.</p>
<h3>Retry Timing Configuration</h3>
<pre><code class="language-python">RETRY_CONFIG = {
    &quot;initial_timeout_ms&quot;: 30_000,     # 30s for first attempt
    &quot;fallback_timeout_ms&quot;: 20_000,    # 20s for fallback attempts (faster fail)
    &quot;max_retries_per_model&quot;: 1,       # Don&#39;t retry same model
    &quot;backoff_multiplier&quot;: 1.5,        # Not used (no same-model retry)
    &quot;circuit_breaker_threshold&quot;: 3,   # Failures before skipping model entirely
    &quot;circuit_breaker_reset_ms&quot;: 300_000  # 5 min before trying failed model again
}
</code></pre>
<p><strong>Circuit breaker:</strong> If a model fails 3 times in 5 minutes, skip it entirely for the next 5 minutes. This prevents repeatedly hitting a down service.</p>
<h2>Fallback Chains</h2>
<p>When the preferred model fails (rate limit, API down, error), cascade to the next option:</p>
<h3>Code Tasks</h3>
<pre><code>Opus â†’ Sonnet â†’ GPT-5 â†’ Gemini Pro
</code></pre>
<h3>Analysis Tasks</h3>
<pre><code>Opus â†’ GPT-5 â†’ Gemini Pro â†’ Sonnet
</code></pre>
<h3>Creative Tasks</h3>
<pre><code>Opus â†’ GPT-5 â†’ Sonnet â†’ Gemini Pro
</code></pre>
<h3>Real-time Tasks</h3>
<pre><code>Grok-2 â†’ Grok-3 â†’ (warn: no real-time fallback)
</code></pre>
<h3>General Tasks</h3>
<pre><code>Flash â†’ Haiku â†’ Sonnet â†’ GPT-5
</code></pre>
<h3>Long Context (Tiered by Size)</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  LONG CONTEXT FALLBACK CHAIN                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  TOKEN COUNT        â”‚ FALLBACK CHAIN                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  128K - 200K        â”‚ Opus (200K) â†’ Sonnet (200K) â†’ Gemini Pro  â”‚
â”‚  200K - 1M          â”‚ Gemini Pro â†’ Flash (1M) â†’ ERROR_MESSAGE   â”‚
â”‚  &gt; 1M               â”‚ ERROR_MESSAGE (no model supports this)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-python">def handle_long_context(token_count: int, available_models: dict) -&gt; str | ErrorMessage:
    &quot;&quot;&quot;Route long-context requests with graceful degradation.&quot;&quot;&quot;
    
    # Tier 1: 128K - 200K tokens (Opus/Sonnet can handle)
    if token_count &lt;= 200_000:
        for model in [&quot;opus&quot;, &quot;sonnet&quot;, &quot;haiku&quot;, &quot;gemini-pro&quot;, &quot;flash&quot;]:
            if model in available_models and get_context_limit(model) &gt;= token_count:
                return model
    
    # Tier 2: 200K - 1M tokens (only Gemini)
    elif token_count &lt;= 1_000_000:
        for model in [&quot;gemini-pro&quot;, &quot;flash&quot;]:
            if model in available_models:
                return model
    
    # Tier 3: &gt; 1M tokens (nothing available)
    # Fall through to error
    
    # No suitable model found â€” return helpful error
    return build_context_error(token_count, available_models)


def build_context_error(token_count: int, available_models: dict) -&gt; ErrorMessage:
    &quot;&quot;&quot;Build a helpful error message when no model can handle the input.&quot;&quot;&quot;
    
    # Find the largest available context window
    max_available = max(
        (get_context_limit(m) for m in available_models),
        default=0
    )
    
    # Determine what&#39;s missing
    missing_models = []
    if &quot;gemini-pro&quot; not in available_models and &quot;flash&quot; not in available_models:
        missing_models.append(&quot;Gemini Pro/Flash (1M context)&quot;)
    if token_count &lt;= 200_000 and &quot;opus&quot; not in available_models:
        missing_models.append(&quot;Opus (200K context)&quot;)
    
    # Format token count for readability
    if token_count &gt;= 1_000_000:
        token_display = f&quot;{token_count / 1_000_000:.1f}M&quot;
    else:
        token_display = f&quot;{token_count // 1000}K&quot;
    
    return ErrorMessage(
        title=&quot;Context Window Exceeded&quot;,
        message=f&quot;&quot;&quot;Your input is approximately **{token_display} tokens**, which exceeds the context window of all currently available models.

**Required:** Gemini Pro (1M context) {&quot;â€” currently unavailable&quot; if &quot;gemini-pro&quot; not in available_models else &quot;&quot;}
**Your max available:** {max_available // 1000}K tokens

**Options:**
1. **Wait and retry** â€” Gemini may be temporarily down
2. **Reduce input size** â€” Remove unnecessary content to fit within {max_available // 1000}K tokens
3. **Split into chunks** â€” I can process your input sequentially in smaller pieces

Would you like me to help split this into manageable chunks?&quot;&quot;&quot;,
        
        recoverable=True,
        suggested_action=&quot;split_chunks&quot;
    )
</code></pre>
<p><strong>Example Error Output:</strong></p>
<pre><code>âš ï¸ Context Window Exceeded

Your input is approximately **340K tokens**, which exceeds the context 
window of all currently available models.

Required: Gemini Pro (1M context) â€” currently unavailable
Your max available: 200K tokens

Options:
1. Wait and retry â€” Gemini may be temporarily down
2. Reduce input size â€” Remove unnecessary content to fit within 200K tokens
3. Split into chunks â€” I can process your input sequentially in smaller pieces

Would you like me to help split this into manageable chunks?
</code></pre>
<h2>Dynamic Model Discovery</h2>
<p>The router auto-detects available providers at runtime:</p>
<pre><code>1. Check configured auth profiles
2. Build available model list from authenticated providers
3. Construct routing table using ONLY available models
4. If preferred model unavailable, use best available alternative
</code></pre>
<p><strong>Example</strong>: If only Anthropic and Google are configured:</p>
<ul>
<li>Code tasks â†’ Opus (Anthropic available âœ“)</li>
<li>Real-time tasks â†’ âš ï¸ No Grok â†’ Fall back to Opus + warn user</li>
<li>Long docs â†’ Gemini Pro (Google available âœ“)</li>
</ul>
<h2>Cost Optimization</h2>
<p>The router considers cost when complexity is LOW:</p>
<table>
<thead>
<tr>
<th>Model</th>
<th>Cost Tier</th>
<th>Use When</th>
</tr>
</thead>
<tbody><tr>
<td>Gemini Flash</td>
<td>$</td>
<td>Simple tasks, high volume</td>
</tr>
<tr>
<td>Claude Haiku</td>
<td>$</td>
<td>Simple tasks, quick responses</td>
</tr>
<tr>
<td>Claude Sonnet</td>
<td>$$</td>
<td>Medium complexity</td>
</tr>
<tr>
<td>Grok 2</td>
<td>$$</td>
<td>Real-time needs only</td>
</tr>
<tr>
<td>GPT-5</td>
<td>$$</td>
<td>General fallback</td>
</tr>
<tr>
<td>Gemini Pro</td>
<td>$$$</td>
<td>Long context needs</td>
</tr>
<tr>
<td>Claude Opus</td>
<td>$$$$</td>
<td>Complex/critical tasks</td>
</tr>
</tbody></table>
<p><strong>Rule</strong>: Never use Opus ($$$) for tasks that Flash ($) can handle.</p>
<h2>User Controls</h2>
<h3>Show Routing Decision</h3>
<p>Add <code>[show routing]</code> to any message:</p>
<pre><code>[show routing] What&#39;s the weather in NYC?
</code></pre>
<p>Output includes:</p>
<pre><code>[Routed â†’ xai/grok-2-latest | Reason: REALTIME intent detected | Fallback: none available]
</code></pre>
<h3>Force Specific Model</h3>
<p>Explicit overrides:</p>
<ul>
<li>&quot;use grok: ...&quot; â†’ Forces Grok</li>
<li>&quot;use claude: ...&quot; â†’ Forces Opus</li>
<li>&quot;use gemini: ...&quot; â†’ Forces Gemini Pro</li>
<li>&quot;use flash: ...&quot; â†’ Forces Gemini Flash</li>
<li>&quot;use gpt: ...&quot; â†’ Forces GPT-5</li>
</ul>
<h3>Check Router Status</h3>
<p>Ask: &quot;router status&quot; or &quot;/router&quot; to see:</p>
<ul>
<li>Available providers</li>
<li>Configured models</li>
<li>Current routing table</li>
<li>Recent routing decisions</li>
</ul>
<h2>Implementation Notes</h2>
<h3>For Agent Implementation</h3>
<p>When processing a request:</p>
<pre><code>1. DETECT available models (check auth profiles)
2. CLASSIFY intent (code/analysis/creative/realtime/general)
3. ESTIMATE complexity (simple/medium/complex)
4. CHECK special cases (context size, vision, explicit override)
5. FILTER by cost tier based on complexity â† BEFORE model selection
6. SELECT model from filtered pool using routing matrix
7. VERIFY model available, else use fallback chain (also cost-filtered)
8. EXECUTE request with selected model
9. IF failure, try next in fallback chain
10. LOG routing decision (for debugging)
</code></pre>
<h3>Cost-Aware Routing Flow (Critical Order)</h3>
<pre><code class="language-python">def route_with_fallback(request):
    &quot;&quot;&quot;
    Main routing function with CORRECT execution order.
    Cost filtering MUST happen BEFORE routing table lookup.
    &quot;&quot;&quot;
    
    # Step 1: Discover available models
    available_models = discover_providers()
    
    # Step 2: Classify intent
    intent = classify_intent(request)
    
    # Step 3: Estimate complexity
    complexity = estimate_complexity(request)
    
    # Step 4: Check special-case overrides (these bypass cost filtering)
    if user_override := get_user_model_override(request):
        return execute_with_fallback(user_override, [])  # No cost filter for explicit override
    
    if token_count &gt; 128_000:
        return handle_long_context(token_count, available_models)  # Special handling
    
    if needs_realtime(request):
        return execute_with_fallback(&quot;grok-2&quot;, [&quot;grok-3&quot;])  # Realtime bypasses cost
    
    # â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    # â”‚  STEP 5: FILTER BY COST TIER â€” THIS MUST COME FIRST!       â”‚
    # â”‚                                                             â”‚
    # â”‚  Cost filtering happens BEFORE the routing table lookup,   â”‚
    # â”‚  NOT after. This ensures &quot;what&#39;s 2+2?&quot; never considers     â”‚
    # â”‚  Opus even momentarily.                                    â”‚
    # â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    allowed_tiers = get_allowed_tiers(complexity)
    # SIMPLE  â†’ [&quot;$&quot;]
    # MEDIUM  â†’ [&quot;$&quot;, &quot;$$&quot;]
    # COMPLEX â†’ [&quot;$&quot;, &quot;$$&quot;, &quot;$$$&quot;]
    
    cost_filtered_models = {
        model: meta for model, meta in available_models.items()
        if COST_TIERS.get(model) in allowed_tiers
    }
    
    # Step 6: NOW select from cost-filtered pool using routing preferences
    preferences = ROUTING_PREFERENCES.get((intent, complexity), [])
    
    for model in preferences:
        if model in cost_filtered_models:  # Only consider cost-appropriate models
            selected_model = model
            break
    else:
        # No preferred model in cost-filtered pool â€” use cheapest available
        selected_model = select_cheapest(cost_filtered_models)
    
    # Step 7: Build cost-filtered fallback chain
    task_type = get_task_type(intent, complexity)
    full_chain = MASTER_FALLBACK_CHAINS.get(task_type, [])
    filtered_chain = [m for m in full_chain if m in cost_filtered_models and m != selected_model]
    
    # Step 8-10: Execute with fallback + logging
    return execute_with_fallback(selected_model, filtered_chain)


def get_allowed_tiers(complexity: str) -&gt; list[str]:
    &quot;&quot;&quot;Return allowed cost tiers for a given complexity level.&quot;&quot;&quot;
    return {
        &quot;SIMPLE&quot;:  [&quot;$&quot;],                      # Budget only â€” no exceptions
        &quot;MEDIUM&quot;:  [&quot;$&quot;, &quot;$$&quot;],                # Budget + standard
        &quot;COMPLEX&quot;: [&quot;$&quot;, &quot;$$&quot;, &quot;$$$&quot;, &quot;$$$$&quot;], # All tiers â€” complex tasks deserve the best
    }.get(complexity, [&quot;$&quot;, &quot;$$&quot;])


# Example flow for &quot;what&#39;s 2+2?&quot;:
#
# 1. available_models = {opus, sonnet, haiku, flash, grok-2, ...}
# 2. intent = GENERAL
# 3. complexity = SIMPLE
# 4. (no special cases)
# 5. allowed_tiers = [&quot;$&quot;]  â† SIMPLE means $ only
#    cost_filtered_models = {haiku, flash, grok-2}  â† Opus/Sonnet EXCLUDED
# 6. preferences for (GENERAL, SIMPLE) = [flash, haiku, grok-2, sonnet]
#    first match in cost_filtered = flash âœ“
# 7. fallback_chain = [haiku, grok-2]  â† Also cost-filtered
# 8. execute with flash
#
# Result: Opus is NEVER considered, not even momentarily.
</code></pre>
<h3>Cost Optimization: Two Approaches</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           COST OPTIMIZATION IMPLEMENTATION OPTIONS               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  APPROACH 1: Explicit filter_by_cost() (shown above)            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â€¢ Calls get_allowed_tiers(complexity) explicitly               â”‚
â”‚  â€¢ Filters available_models BEFORE routing table lookup         â”‚
â”‚  â€¢ Most defensive â€” impossible to route wrong tier              â”‚
â”‚  â€¢ Recommended for security-critical deployments                â”‚
â”‚                                                                  â”‚
â”‚  APPROACH 2: Preference ordering (implicit)                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â€¢ ROUTING_PREFERENCES lists cheapest capable models first      â”‚
â”‚  â€¢ For SIMPLE tasks: [flash, haiku, grok-2, sonnet]            â”‚
â”‚  â€¢ First available match wins â†’ naturally picks cheapest        â”‚
â”‚  â€¢ Simpler code, relies on correct preference ordering          â”‚
â”‚                                                                  â”‚
â”‚  This implementation uses BOTH for defense-in-depth:            â”‚
â”‚  â€¢ Preference ordering provides first line of cost awareness    â”‚
â”‚  â€¢ Explicit filter_by_cost() guarantees tier enforcement        â”‚
â”‚                                                                  â”‚
â”‚  For alternative implementations that rely solely on            â”‚
â”‚  preference ordering, see references/models.md for the          â”‚
â”‚  filter_by_cost() function if explicit enforcement is needed.   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3>Spawning with Different Models</h3>
<p>Use sessions_spawn for model routing:</p>
<pre><code>sessions_spawn(
  task: &quot;user&#39;s request&quot;,
  model: &quot;selected/model-id&quot;,
  label: &quot;task-type-query&quot;
)
</code></pre>
<h2>Security</h2>
<ul>
<li>Never send sensitive data to untrusted models</li>
<li>API keys handled via environment/auth profiles only</li>
<li>See <code>references/security.md</code> for full security guidance</li>
</ul>
<h2>Model Details</h2>
<p>See <code>references/models.md</code> for detailed capabilities and pricing.</p>

                </div>
              </div>
            </article>
            <aside class="skill-page-sidebar">
              <div class="sidebar-card">
                <div class="sidebar-title">Actions</div>
                <a href="https://github.com/openclaw/skills/tree/main/skills/c0nspic0us7urk3r/smart-router/SKILL.md" target="_blank" rel="noopener" class="sidebar-btn sidebar-btn-primary">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/></svg>
                  View on GitHub
                </a>
                <a href="https://clawdhub.com/c0nspic0us7urk3r/smart-router" target="_blank" rel="noopener" class="sidebar-btn sidebar-btn-clawdhub">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/><line x1="2" y1="12" x2="22" y2="12"/></svg>
                  View on ClawdHub
                </a>
                <a href="https://raw.githubusercontent.com/openclaw/skills/main/skills/c0nspic0us7urk3r/smart-router/SKILL.md" download="SKILL.md" class="sidebar-btn sidebar-btn-secondary">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                  Download SKILL.md
                </a>
                <button onclick="sendToSecurityAuditor()" class="sidebar-btn sidebar-btn-security">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                  Security Check
                </button>
              </div>
              <div class="sidebar-card">
                <div class="sidebar-title">Details</div>
                <div class="sidebar-info">
                  <div class="sidebar-info-item">
                    <span class="sidebar-info-label">Author</span>
                    <span class="sidebar-info-value">@c0nspic0us7urk3r</span>
                  </div>
                  <div class="sidebar-info-item">
                    <span class="sidebar-info-label">Category</span>
                    <span class="sidebar-info-value">Web & Frontend Development</span>
                  </div>
                </div>
              </div>
            </aside>
          </div>
        
  <footer class="footer">
    <div class="footer-inner">
      <p class="footer-text" style="margin-bottom: 8px;"><a href="https://github.com/neonone123/moltdirectory" target="_blank" rel="noopener" style="color: var(--accent); text-decoration: none;">View on GitHub</a></p>
      <p class="footer-text" style="opacity: 0.6; font-size: 13px;">OpenClawDirectory.com is a community-run project and is not affiliated with the official OpenClaw team or Peter Steinberger. We are just fans of the lobster.</p>
    </div>
  </footer>
  <script>
    function toggleTheme() {
      const html = document.documentElement;
      const currentTheme = html.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      if (newTheme === 'light') {
        html.setAttribute('data-theme', 'light');
      } else {
        html.removeAttribute('data-theme');
      }
      localStorage.setItem('theme', newTheme);
    }
    
    function copySkillContent(btn) {
      const wrapper = btn.closest('.skill-source-wrapper');
      const content = wrapper.querySelector('.markdown-content');
      if (content) {
        const text = content.innerText || content.textContent;
        navigator.clipboard.writeText(text).then(() => {
          btn.classList.add('copied');
          btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg> Copied!';
          setTimeout(() => {
            btn.classList.remove('copied');
            btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copy';
          }, 2000);
        });
      }
    }

    async function sendToSecurityAuditor() {
      try {
        const contentElement = document.querySelector('.markdown-content');
        if (!contentElement) throw new Error('Could not find markdown content');
        const skillContent = contentElement.innerText || contentElement.textContent;
        localStorage.setItem('skillAuditContent', skillContent);
        window.open('/security-auditor', '_blank'); 
      } catch (error) {
        alert('Error: ' + error.message);
      }
    }
  </script>
</body>
</html>