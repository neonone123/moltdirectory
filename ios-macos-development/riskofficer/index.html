<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Manage investment portfolios, calculate risk metrics">
  <title>riskofficer - OpenClaw Directory</title>
  <link rel="canonical" href="https://moltdirectory.com/ios-macos-development/riskofficer/">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü¶û</text></svg>">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
  <script>
    // Apply saved theme before page renders to prevent flash
    (function() {
      const savedTheme = localStorage.getItem('theme') || 'dark';
      if (savedTheme === 'light') {
        document.documentElement.setAttribute('data-theme', 'light');
      }
    })();
  </script>
</head>
<body>
  <header class="header">
    <div class="header-inner">
      <a href="/" class="logo">

        <span class="logo-text">OpenClaw Directory</span>
      </a>
      <nav class="header-links">
        <a href="/start-here/" class="header-link">Start Here</a>
        <a href="/security-auditor" class="header-link">Security Auditor</a>
        <a href="https://github.com/neonone123/moltdirectory/issues/new?template=add-skill.yml" class="header-link" target="_blank" rel="noopener">Add Skill</a>
        <button class="theme-toggle" aria-label="Toggle theme" onclick="toggleTheme()">
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
        </button>
        <a href="https://www.reddit.com/r/OpenClawDirectory/" class="header-link" target="_blank" rel="noopener" aria-label="Community">
          <svg viewBox="0 0 16 16" fill="currentColor" width="28" height="28"><path d="M6.167 8a.83.83 0 0 0-.83.83c0 .459.372.84.83.831a.831.831 0 0 0 0-1.661m1.843 3.647c.315 0 1.403-.038 1.976-.611a.23.23 0 0 0 0-.306.213.213 0 0 0-.306 0c-.353.363-1.126.487-1.67.487-.545 0-1.308-.124-1.671-.487a.213.213 0 0 0-.306 0 .213.213 0 0 0 0 .306c.564.563 1.652.61 1.977.61zm.992-2.807c0 .458.373.83.831.83s.83-.381.83-.83a.831.831 0 0 0-1.66 0z"/><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.828-1.165c-.315 0-.602.124-.812.325-.801-.573-1.9-.945-3.121-.993l.534-2.501 1.738.372a.83.83 0 1 0 .83-.869.83.83 0 0 0-.744.468l-1.938-.41a.2.2 0 0 0-.153.028.2.2 0 0 0-.086.134l-.592 2.788c-1.24.038-2.358.41-3.17.992-.21-.2-.496-.324-.81-.324a1.163 1.163 0 0 0-.478 2.224q-.03.17-.029.353c0 1.795 2.091 3.256 4.669 3.256s4.668-1.451 4.668-3.256c0-.114-.01-.238-.029-.353.401-.181.688-.592.688-1.069 0-.65-.525-1.165-1.165-1.165"/></svg>
        </a>
      </nav>
    </div>
  </header>
  
          <section class="skill-page-header">
            <div class="skill-page-header-inner">
              <a href="/ios-macos-development/" class="back-link">‚Üê Back to iOS & macOS Development</a>
              <div class="skill-page-meta">
                <a href="/ios-macos-development/" class="skill-page-category">iOS & macOS Development</a>
                <span class="skill-page-author">by @mib424242</span>
              </div>
              <h1 class="skill-page-title">riskofficer</h1>
              <p class="skill-page-desc">Manage investment portfolios, calculate risk metrics</p>
            </div>
          </section>
          <div class="skill-page-body">
            <article class="skill-page-content">
              <div class="skill-source-wrapper">
                <div class="skill-source-header">
                  <div class="skill-source-title">Source Code</div>
                  <button class="copy-btn" onclick="copySkillContent(this)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                    Copy
                  </button>
                </div>
                <div class="markdown-content">
                  <h2>RiskOfficer Portfolio Management</h2>
<p>This skill connects to RiskOfficer API to manage investment portfolios and calculate risks.</p>
<h3>Setup</h3>
<ol>
<li>Open RiskOfficer app ‚Üí Settings ‚Üí API Keys</li>
<li>Create new token for &quot;OpenClaw&quot;</li>
<li>Set environment variable: <code>RISK_OFFICER_TOKEN=ro_pat_...</code></li>
</ol>
<p>Or configure in <code>~/.openclaw/openclaw.json</code>:</p>
<pre><code class="language-json">{
  &quot;skills&quot;: {
    &quot;entries&quot;: {
      &quot;riskofficer&quot;: {
        &quot;enabled&quot;: true,
        &quot;apiKey&quot;: &quot;ro_pat_...&quot;
      }
    }
  }
}
</code></pre>
<h3>API Base URL</h3>
<pre><code>https://api.riskofficer.tech/api/v1
</code></pre>
<p>All requests require header: <code>Authorization: Bearer ${RISK_OFFICER_TOKEN}</code></p>
<hr>
<h2>Available Commands</h2>
<h3>Portfolio Management</h3>
<h4>List Portfolios</h4>
<p>When user asks to see their portfolios, list portfolios, or show portfolio overview:</p>
<pre><code class="language-bash">curl -s &quot;https://api.riskofficer.tech/api/v1/portfolios/list&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot;
</code></pre>
<p>Response contains array of portfolios with: id, name, total_value, currency, positions_count, broker, sandbox.</p>
<h4>Get Portfolio Details</h4>
<p>When user asks about a specific portfolio or wants to see positions:</p>
<pre><code class="language-bash">curl -s &quot;https://api.riskofficer.tech/api/v1/portfolio/snapshot/{snapshot_id}&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot;
</code></pre>
<p>Response contains: name, total_value, currency, positions (array with ticker, quantity, current_price, value, weight).</p>
<h4>Get Portfolio History</h4>
<p>When user asks for portfolio history, how portfolio changed over time, or list of past snapshots:</p>
<pre><code class="language-bash">curl -s &quot;https://api.riskofficer.tech/api/v1/portfolio/history?days=30&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot;
</code></pre>
<p><strong>Query params:</strong> <code>days</code> (optional, default 30, 1‚Äì365). Response: <code>snapshots</code> array with <code>snapshot_id</code>, <code>timestamp</code>, <code>total_value</code>, <code>positions_count</code>, <code>sync_source</code>, <code>type</code> (aggregated/manual/broker), <code>name</code>, <code>broker</code>, <code>sandbox</code>.</p>
<h4>Get Snapshot Diff (compare two portfolio versions)</h4>
<p>When user wants to compare two portfolio states (e.g. before/after rebalance, or two dates):</p>
<pre><code class="language-bash">curl -s &quot;https://api.riskofficer.tech/api/v1/portfolio/snapshot/{snapshot_id}/diff?compare_to={other_snapshot_id}&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot;
</code></pre>
<p>Response: added/removed/modified positions, <code>total_value_delta</code>. Both snapshots must belong to the user.</p>
<h4>Get Aggregated Portfolio</h4>
<p>When user asks for total/combined portfolio, overall position, or &quot;show everything together&quot;:</p>
<pre><code class="language-bash">curl -s &quot;https://api.riskofficer.tech/api/v1/portfolio/aggregated?type=all&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot;
</code></pre>
<p><strong>Query params:</strong></p>
<ul>
<li><code>type=production</code> ‚Äî manual + broker (sandbox=false)</li>
<li><code>type=sandbox</code> ‚Äî broker (sandbox=true) only</li>
<li><code>type=all</code> ‚Äî everything (default)</li>
</ul>
<p><strong>Response:</strong></p>
<ul>
<li><code>portfolio.positions</code> ‚Äî all positions merged across portfolios</li>
<li><code>portfolio.total_value</code> ‚Äî total value in base currency</li>
<li><code>portfolio.currency</code> ‚Äî base currency (RUB or USD)</li>
<li><code>portfolio.sources_count</code> ‚Äî number of portfolios aggregated</li>
</ul>
<p><strong>Example response:</strong></p>
<pre><code class="language-json">{
  &quot;portfolio&quot;: {
    &quot;positions&quot;: [
      {&quot;ticker&quot;: &quot;SBER&quot;, &quot;quantity&quot;: 150, &quot;value&quot;: 42795, &quot;sources&quot;: [&quot;–¢-–ë–∞–Ω–∫&quot;, &quot;Manual&quot;]},
      {&quot;ticker&quot;: &quot;AAPL&quot;, &quot;quantity&quot;: 10, &quot;value&quot;: 189500, &quot;original_currency&quot;: &quot;USD&quot;}
    ],
    &quot;total_value&quot;: 1500000,
    &quot;currency&quot;: &quot;RUB&quot;,
    &quot;sources_count&quot;: 3
  },
  &quot;snapshot_id&quot;: &quot;uuid-of-aggregated&quot;
}
</code></pre>
<p><strong>Currency conversion:</strong> Positions in different currencies are automatically converted to base currency using current exchange rates (CBR for RUB).</p>
<h4>Change Base Currency (Aggregated Portfolio)</h4>
<p>When user wants to see aggregated portfolio in different currency:</p>
<pre><code class="language-bash">curl -s -X PATCH &quot;https://api.riskofficer.tech/api/v1/portfolio/{aggregated_snapshot_id}/settings&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{&quot;base_currency&quot;: &quot;USD&quot;}&#39;
</code></pre>
<p><strong>Supported currencies:</strong> <code>RUB</code>, <code>USD</code></p>
<p>After changing, aggregated portfolio recalculates automatically.</p>
<p><strong>User prompt examples:</strong></p>
<ul>
<li>&quot;–ü–æ–∫–∞–∂–∏ –≤—Å—ë –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö&quot; ‚Üí change base_currency to USD</li>
<li>&quot;–ü–µ—Ä–µ–≤–µ–¥–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—å –≤ —Ä—É–±–ª–∏&quot; ‚Üí change base_currency to RUB</li>
</ul>
<h4>Include/Exclude from Aggregated</h4>
<p>When user wants to exclude a portfolio from total calculation:</p>
<pre><code class="language-bash">curl -s -X PATCH &quot;https://api.riskofficer.tech/api/v1/portfolio/{snapshot_id}/settings&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{&quot;include_in_aggregated&quot;: false}&#39;
</code></pre>
<p><strong>Use cases:</strong></p>
<ul>
<li>&quot;–ù–µ —É—á–∏—Ç—ã–≤–∞–π –ø–µ—Å–æ—á–Ω–∏—Ü—É –≤ –æ–±—â–µ–º –ø–æ—Ä—Ç—Ñ–µ–ª–µ&quot; ‚Üí exclude sandbox</li>
<li>&quot;–£–±–µ—Ä–∏ –¥–µ–º–æ-–ø–æ—Ä—Ç—Ñ–µ–ª—å –∏–∑ —Ä–∞—Å—á—ë—Ç–∞&quot; ‚Üí exclude manual portfolio</li>
</ul>
<h4>Create Manual Portfolio</h4>
<p>When user wants to create a new portfolio with specific positions:</p>
<pre><code class="language-bash">curl -s -X POST &quot;https://api.riskofficer.tech/api/v1/portfolio/manual&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{
    &quot;name&quot;: &quot;Portfolio Name&quot;,
    &quot;positions&quot;: [
      {&quot;ticker&quot;: &quot;SBER&quot;, &quot;quantity&quot;: 100},
      {&quot;ticker&quot;: &quot;GAZP&quot;, &quot;quantity&quot;: 50}
    ]
  }&#39;
</code></pre>
<p><strong>IMPORTANT RULE - Single Currency:</strong>
All assets in a portfolio must be in the same currency. </p>
<ul>
<li>RUB assets: SBER, GAZP, LKOH, YNDX, etc.</li>
<li>USD assets: AAPL, MSFT, GOOGL, etc.
Cannot mix! If user tries to mix currencies, explain and suggest creating separate portfolios.</li>
</ul>
<h4>Update Portfolio (Add/Remove Positions)</h4>
<p>When user wants to modify an existing portfolio:</p>
<ol>
<li>First get current portfolio to find the name:</li>
</ol>
<pre><code class="language-bash">curl -s &quot;https://api.riskofficer.tech/api/v1/portfolio/snapshot/{snapshot_id}&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot;
</code></pre>
<ol start="2">
<li>Then create new snapshot with updated positions (use same name):</li>
</ol>
<pre><code class="language-bash">curl -s -X POST &quot;https://api.riskofficer.tech/api/v1/portfolio/manual&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{
    &quot;name&quot;: &quot;&lt;same name from step 1&gt;&quot;,
    &quot;positions&quot;: [&lt;updated list of all positions&gt;]
  }&#39;
</code></pre>
<p><strong>IMPORTANT:</strong> Always show user what will change and ask for confirmation before updating.</p>
<hr>
<h3>Broker Integration</h3>
<h4>List Connected Brokers</h4>
<p>When user asks about connected brokers or broker status:</p>
<pre><code class="language-bash">curl -s &quot;https://api.riskofficer.tech/api/v1/brokers/connections&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot;
</code></pre>
<h4>Refresh Portfolio from Tinkoff</h4>
<p>When user wants to sync/update portfolio from Tinkoff (broker must be connected via app):</p>
<pre><code class="language-bash">curl -s -X POST &quot;https://api.riskofficer.tech/api/v1/portfolio/proxy/broker/tinkoff/portfolio&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{&quot;sandbox&quot;: false}&#39;
</code></pre>
<p>If response is 400 with <code>missing_api_key</code>, broker is not connected. Explain how to connect:</p>
<ol>
<li>Get API token from <a href="https://www.tbank.ru/invest/settings/api/">https://www.tbank.ru/invest/settings/api/</a></li>
<li>Open RiskOfficer app ‚Üí Settings ‚Üí Brokers ‚Üí Connect Tinkoff</li>
<li>Paste token and connect</li>
</ol>
<hr>
<h3>Risk Calculations</h3>
<h4>Calculate VaR (FREE)</h4>
<p>When user asks to calculate risks, VaR, or risk metrics:</p>
<pre><code class="language-bash">curl -s -X POST &quot;https://api.riskofficer.tech/api/v1/risk/calculate-var&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{
    &quot;portfolio_snapshot_id&quot;: &quot;{snapshot_id}&quot;,
    &quot;method&quot;: &quot;historical&quot;,
    &quot;confidence&quot;: 0.95,
    &quot;horizon_days&quot;: 1,
    &quot;force_recalc&quot;: false
  }&#39;
</code></pre>
<ul>
<li><strong>Methods:</strong> <code>historical</code>, <code>parametric</code>, <code>garch</code></li>
<li><strong>force_recalc</strong> (optional, default false): If user wants a fresh calculation ignoring cache (e.g. &quot;recalculate VaR&quot;, &quot;refresh risk&quot;), set <code>&quot;force_recalc&quot;: true</code>. Otherwise the API may return a cached result when prices have not changed.</li>
</ul>
<p>This returns <code>calculation_id</code>. Poll for result:</p>
<pre><code class="language-bash">curl -s &quot;https://api.riskofficer.tech/api/v1/risk/calculation/{calculation_id}&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot;
</code></pre>
<p>Wait until <code>status</code> is <code>done</code>, then present results. If the POST response already has <code>status: &quot;done&quot;</code> and <code>var_95</code>/<code>cvar_95</code> (cached result), you can present those without polling.</p>
<h4>Get VaR / Risk Calculation History</h4>
<p>When user asks for last risk calculations, previous VaR results, or &quot;show my risk history&quot;:</p>
<pre><code class="language-bash">curl -s &quot;https://api.riskofficer.tech/api/v1/risk/history?limit=50&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot;
</code></pre>
<p><strong>Query params:</strong> <code>limit</code> (optional, default 50, max 100).</p>
<p><strong>Response:</strong> <code>calculations</code> array with <code>calculation_id</code>, <code>portfolio_snapshot_id</code>, <code>status</code>, <code>method</code>, <code>var_95</code>, <code>cvar_95</code>, <code>sharpe_ratio</code>, <code>created_at</code>, <code>completed_at</code>. Use to show a short list of recent VaR runs or to let user pick a past result.</p>
<h4>Run Monte Carlo (QUANT - currently free for all users)</h4>
<p>When user asks for Monte Carlo simulation:</p>
<pre><code class="language-bash">curl -s -X POST &quot;https://api.riskofficer.tech/api/v1/risk/monte-carlo&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{
    &quot;portfolio_snapshot_id&quot;: &quot;{snapshot_id}&quot;,
    &quot;simulations&quot;: 1000,
    &quot;horizon_days&quot;: 365,
    &quot;model&quot;: &quot;gbm&quot;
  }&#39;
</code></pre>
<p>Poll: <code>GET /api/v1/risk/monte-carlo/{simulation_id}</code></p>
<h4>Run Stress Test (QUANT - currently free for all users)</h4>
<p>When user asks for stress test:</p>
<p>First, get available crises:</p>
<pre><code class="language-bash">curl -s &quot;https://api.riskofficer.tech/api/v1/risk/stress-test/crises&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot;
</code></pre>
<p>Then run stress test:</p>
<pre><code class="language-bash">curl -s -X POST &quot;https://api.riskofficer.tech/api/v1/risk/stress-test&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{
    &quot;portfolio_snapshot_id&quot;: &quot;{snapshot_id}&quot;,
    &quot;crisis&quot;: &quot;covid_19&quot;
  }&#39;
</code></pre>
<p>Poll: <code>GET /api/v1/risk/stress-test/{stress_test_id}</code></p>
<hr>
<h3>Portfolio Optimization (QUANT - currently free for all users)</h3>
<h4>Risk Parity Optimization</h4>
<p>When user asks to optimize portfolio or balance risks:</p>
<pre><code class="language-bash">curl -s -X POST &quot;https://api.riskofficer.tech/api/v1/portfolio/{snapshot_id}/optimize&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{
    &quot;optimization_mode&quot;: &quot;preserve_directions&quot;,
    &quot;constraints&quot;: {
      &quot;max_weight&quot;: 0.30,
      &quot;min_weight&quot;: 0.02
    }
  }&#39;
</code></pre>
<p>Modes:</p>
<ul>
<li><code>long_only</code>: All weights ‚â• 0</li>
<li><code>preserve_directions</code>: Keep long/short as-is</li>
<li><code>unconstrained</code>: Any direction allowed</li>
</ul>
<p>Poll: <code>GET /api/v1/portfolio/optimizations/{optimization_id}</code>
Result: <code>GET /api/v1/portfolio/optimizations/{optimization_id}/result</code></p>
<h4>Calmar Ratio Optimization</h4>
<p>When user asks for Calmar optimization, maximize Calmar Ratio (CAGR / |Max Drawdown|). <strong>Requires 200+ trading days of price history</strong> per ticker (backend requests 252 days). If user has short history, suggest Risk Parity instead.</p>
<pre><code class="language-bash">curl -s -X POST &quot;https://api.riskofficer.tech/api/v1/portfolio/{snapshot_id}/optimize-calmar&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{
    &quot;optimization_mode&quot;: &quot;long_only&quot;,
    &quot;constraints&quot;: {
      &quot;max_weight&quot;: 0.50,
      &quot;min_weight&quot;: 0.05,
      &quot;min_expected_return&quot;: 0.0,
      &quot;max_drawdown_limit&quot;: 0.15,
      &quot;min_calmar_target&quot;: 0.5
    }
  }&#39;
</code></pre>
<p>Poll: <code>GET /api/v1/portfolio/optimizations/{optimization_id}</code> (check <code>optimization_type === &quot;calmar_ratio&quot;</code>).<br>Result: <code>GET /api/v1/portfolio/optimizations/{optimization_id}/result</code> ‚Äî includes <code>current_metrics</code>, <code>optimized_metrics</code> (cagr, max_drawdown, calmar_ratio, recovery_time_days).<br>Apply: same as Risk Parity ‚Äî <code>POST /api/v1/portfolio/optimizations/{optimization_id}/apply</code>.</p>
<h4>Apply Optimization</h4>
<p><strong>IMPORTANT:</strong> Always show rebalancing plan and ask for explicit user confirmation first!</p>
<pre><code class="language-bash">curl -s -X POST &quot;https://api.riskofficer.tech/api/v1/portfolio/optimizations/{optimization_id}/apply&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot;
</code></pre>
<hr>
<h3>Subscription Status</h3>
<blockquote>
<p><strong>Note:</strong> Quant subscription is currently <strong>FREE for all users</strong>. All features work without payment.</p>
</blockquote>
<h4>Check Subscription</h4>
<p>When you need to check if user has Quant subscription:</p>
<pre><code class="language-bash">curl -s &quot;https://api.riskofficer.tech/api/v1/subscription/status&quot; \
  -H &quot;Authorization: Bearer ${RISK_OFFICER_TOKEN}&quot;
</code></pre>
<p>Currently all users have <code>has_subscription: true</code> (free tier enabled).</p>
<hr>
<h2>Async Operations</h2>
<p>VaR, Monte Carlo, Stress Test, and Optimization are <strong>asynchronous</strong>. </p>
<p><strong>Polling pattern:</strong></p>
<ol>
<li>Call POST endpoint ‚Üí get <code>calculation_id</code> / <code>simulation_id</code> / <code>optimization_id</code></li>
<li>Poll GET endpoint every 2-3 seconds</li>
<li>Check <code>status</code> field:<ul>
<li><code>pending</code> or <code>processing</code> ‚Üí keep polling</li>
<li><code>done</code> ‚Üí present results</li>
<li><code>failed</code> ‚Üí show error message</li>
</ul>
</li>
</ol>
<p><strong>Typical times:</strong></p>
<table>
<thead>
<tr>
<th>Operation</th>
<th>Typical Time</th>
</tr>
</thead>
<tbody><tr>
<td>VaR</td>
<td>3-10 seconds</td>
</tr>
<tr>
<td>Monte Carlo</td>
<td>10-30 seconds</td>
</tr>
<tr>
<td>Stress Test</td>
<td>5-15 seconds</td>
</tr>
<tr>
<td>Optimization</td>
<td>10-30 seconds</td>
</tr>
</tbody></table>
<p><strong>User communication:</strong></p>
<ul>
<li>Show &quot;Calculating...&quot; message immediately after starting</li>
<li>If polling takes &gt;10 seconds, update: &quot;Still calculating... please wait&quot;</li>
<li>Always show result or error when complete</li>
</ul>
<hr>
<h2>Important Rules</h2>
<ol>
<li><p><strong>Single Currency Rule (Manual/Broker portfolios):</strong> Each individual portfolio must have same-currency assets. Cannot mix SBER (RUB) with AAPL (USD) in one manual portfolio. Suggest separate portfolios.</p>
</li>
<li><p><strong>Aggregated Portfolio:</strong> The aggregated portfolio CAN contain assets in different currencies - they are automatically converted to base currency (RUB or USD) using CBR rates.</p>
</li>
<li><p><strong>Subscription:</strong> Monte Carlo, Stress Test, and Optimization are Quant features (currently free for all users). VaR is always FREE.</p>
</li>
<li><p><strong>Broker Integration:</strong> User must connect broker in RiskOfficer app first. Cannot connect via chat (security).</p>
</li>
<li><p><strong>Confirmations:</strong> Before applying optimizations or making significant portfolio changes, always show what will change and ask for confirmation.</p>
</li>
<li><p><strong>Async Operations:</strong> VaR, Monte Carlo, Stress Test, and Optimization are async. Poll for results.</p>
</li>
<li><p><strong>Error Handling:</strong></p>
<ul>
<li>401 Unauthorized ‚Üí Token invalid or expired, user needs to recreate</li>
<li>403 subscription_required ‚Üí Need Quant subscription (currently free for all)</li>
<li>400 missing_api_key ‚Üí Broker not connected</li>
<li>400 currency_mismatch ‚Üí Mixed currencies</li>
</ul>
</li>
</ol>
<hr>
<h2>Example Conversations</h2>
<h3>User wants portfolio overview</h3>
<p>User: &quot;Show my portfolios&quot;
‚Üí Call GET /portfolios/list
‚Üí Format nicely with values, positions count, last updated</p>
<h3>User wants combined/total portfolio</h3>
<p>User: &quot;–ü–æ–∫–∞–∂–∏ –≤—Å—ë –≤–º–µ—Å—Ç–µ&quot; / &quot;Total portfolio&quot; / &quot;–°–∫–æ–ª—å–∫–æ —É –º–µ–Ω—è –≤—Å–µ–≥–æ?&quot;
‚Üí Call GET /portfolio/aggregated?type=all
‚Üí Show total value, all positions merged, sources count
‚Üí Note which positions were converted from other currencies</p>
<h3>User wants to change display currency</h3>
<p>User: &quot;–ü–æ–∫–∞–∂–∏ –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö&quot; / &quot;Switch to USD&quot;
‚Üí Call PATCH /portfolio/{aggregated_id}/settings with {&quot;base_currency&quot;: &quot;USD&quot;}
‚Üí Call GET /portfolio/aggregated again
‚Üí Show portfolio in new currency</p>
<h3>User wants to analyze risks</h3>
<p>User: &quot;What are the risks of my main portfolio?&quot;
‚Üí Call GET /portfolios/list to find the portfolio
‚Üí Call POST /risk/calculate-var
‚Üí Poll until done
‚Üí Present VaR, CVaR, volatility, risk contributions
‚Üí Offer optimization if risks are unbalanced</p>
<h3>User wants Calmar optimization</h3>
<p>User: &quot;–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π –ø–æ—Ä—Ç—Ñ–µ–ª—å –ø–æ –ö–∞–ª–º–∞—Ä—É&quot; / &quot;Optimize using Calmar Ratio&quot; / &quot;Maximize return per drawdown&quot;
‚Üí Call GET /portfolios/list or aggregated to get snapshot_id
‚Üí Call POST /portfolio/{snapshot_id}/optimize-calmar with optimization_mode and optional constraints
‚Üí If 400 INSUFFICIENT_HISTORY: explain need 200+ trading days of history, suggest Risk Parity as alternative
‚Üí Poll GET /optimizations/{id} until status is done
‚Üí Call GET /optimizations/{id}/result ‚Äî show current_metrics vs optimized_metrics (Calmar ratio, CAGR, max drawdown)
‚Üí Show rebalancing plan and ask for confirmation before apply</p>
<h3>User tries to mix currencies</h3>
<p>User: &quot;Add Apple to my portfolio&quot;
‚Üí Check portfolio currency (RUB) vs AAPL currency (USD)
‚Üí Explain cannot mix, suggest creating separate USD portfolio</p>
<h3>User requests Monte Carlo or Stress Test</h3>
<p>User: &quot;Run Monte Carlo&quot;
‚Üí Call POST /risk/monte-carlo with portfolio snapshot
‚Üí Poll until done
‚Üí Present simulation results with percentiles and projections</p>
<h3>User asks for risk or VaR history</h3>
<p>User: &quot;Show my last VaR results&quot; / &quot;Previous risk calculations&quot; / &quot;–ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—á—ë—Ç–æ–≤ —Ä–∏—Å–∫–æ–≤&quot;
‚Üí Call GET /risk/history?limit=50
‚Üí Present list of recent calculations (method, var_95, cvar_95, date)</p>
<h3>User asks for portfolio history</h3>
<p>User: &quot;How did my portfolio change?&quot; / &quot;–ò—Å—Ç–æ—Ä–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è&quot;
‚Üí Call GET /portfolio/history?days=30
‚Üí Present snapshots (date, total_value, positions_count, source)</p>
<h3>User wants to compare two portfolio versions</h3>
<p>User: &quot;Compare my portfolio now vs last week&quot; / &quot;–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –ø–æ—Ä—Ç—Ñ–µ–ª–µ?&quot;
‚Üí Get two snapshot_ids from GET /portfolio/history (or from context)
‚Üí Call GET /portfolio/snapshot/{snapshot_id}/diff?compare_to={other_snapshot_id}
‚Üí Present added/removed/modified positions and value delta</p>

                </div>
              </div>
            </article>
            <aside class="skill-page-sidebar">
              <div class="sidebar-card">
                <div class="sidebar-title">Actions</div>
                <a href="https://github.com/openclaw/skills/tree/main/skills/mib424242/riskofficer/SKILL.md" target="_blank" rel="noopener" class="sidebar-btn sidebar-btn-primary">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/></svg>
                  View on GitHub
                </a>
                <a href="https://clawdhub.com/mib424242/riskofficer" target="_blank" rel="noopener" class="sidebar-btn sidebar-btn-clawdhub">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/><line x1="2" y1="12" x2="22" y2="12"/></svg>
                  View on ClawdHub
                </a>
                <a href="https://raw.githubusercontent.com/openclaw/skills/main/skills/mib424242/riskofficer/SKILL.md" download="SKILL.md" class="sidebar-btn sidebar-btn-secondary">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                  Download SKILL.md
                </a>
                <button onclick="sendToSecurityAuditor()" class="sidebar-btn sidebar-btn-security">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                  Security Check
                </button>
              </div>
              <div class="sidebar-card">
                <div class="sidebar-title">Details</div>
                <div class="sidebar-info">
                  <div class="sidebar-info-item">
                    <span class="sidebar-info-label">Author</span>
                    <span class="sidebar-info-value">@mib424242</span>
                  </div>
                  <div class="sidebar-info-item">
                    <span class="sidebar-info-label">Category</span>
                    <span class="sidebar-info-value">iOS & macOS Development</span>
                  </div>
                </div>
              </div>
            </aside>
          </div>
        
  <footer class="footer">
    <div class="footer-inner">
      <p class="footer-text" style="margin-bottom: 8px;"><a href="https://github.com/neonone123/moltdirectory" target="_blank" rel="noopener" style="color: var(--accent); text-decoration: none;">View on GitHub</a></p>
      <p class="footer-text" style="opacity: 0.6; font-size: 13px;">OpenClawDirectory.com is a community-run project and is not affiliated with the official OpenClaw team or Peter Steinberger. We are just fans of the lobster.</p>
    </div>
  </footer>
  <script>
    function toggleTheme() {
      const html = document.documentElement;
      const currentTheme = html.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      if (newTheme === 'light') {
        html.setAttribute('data-theme', 'light');
      } else {
        html.removeAttribute('data-theme');
      }
      localStorage.setItem('theme', newTheme);
    }
    
    function copySkillContent(btn) {
      const wrapper = btn.closest('.skill-source-wrapper');
      const content = wrapper.querySelector('.markdown-content');
      if (content) {
        const text = content.innerText || content.textContent;
        navigator.clipboard.writeText(text).then(() => {
          btn.classList.add('copied');
          btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg> Copied!';
          setTimeout(() => {
            btn.classList.remove('copied');
            btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copy';
          }, 2000);
        });
      }
    }

    async function sendToSecurityAuditor() {
      try {
        const contentElement = document.querySelector('.markdown-content');
        if (!contentElement) throw new Error('Could not find markdown content');
        const skillContent = contentElement.innerText || contentElement.textContent;
        localStorage.setItem('skillAuditContent', skillContent);
        window.open('/security-auditor', '_blank'); 
      } catch (error) {
        alert('Error: ' + error.message);
      }
    }
  </script>
</body>
</html>