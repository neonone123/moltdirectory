<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="> **First time?** Read [SETUP.md](./SETUP.md) first to install dependencies and verify your setup">
  <title>ralph-loops - MoltDirectory</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¦</text></svg>">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../style.css">
  <script>
    // Apply saved theme before page renders to prevent flash
    (function() {
      const savedTheme = localStorage.getItem('theme') || 'dark';
      if (savedTheme === 'light') {
        document.documentElement.setAttribute('data-theme', 'light');
      }
    })();
  </script>
</head>
<body>
  <header class="header">
    <div class="header-inner">
      <a href="../../index.html" class="logo">

        <span class="logo-text">MoltDirectory</span>
      </a>
      <nav class="header-links">
        <a href="../../start-here/index.html" class="header-link">Start Here</a>
        <a href="/security-auditor" class="header-link">Security Auditor</a>
        <a href="https://github.com/neonone123/moltdirectory/issues/new?template=add-skill.yml" class="header-link" target="_blank" rel="noopener">Add Skill</a>
        <button class="theme-toggle" aria-label="Toggle theme" onclick="toggleTheme()">
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
        </button>
        <a href="https://www.reddit.com/r/OpenClawDirectory/" class="header-link" target="_blank" rel="noopener" aria-label="Community">
          <svg viewBox="0 0 16 16" fill="currentColor" width="28" height="28"><path d="M6.167 8a.83.83 0 0 0-.83.83c0 .459.372.84.83.831a.831.831 0 0 0 0-1.661m1.843 3.647c.315 0 1.403-.038 1.976-.611a.23.23 0 0 0 0-.306.213.213 0 0 0-.306 0c-.353.363-1.126.487-1.67.487-.545 0-1.308-.124-1.671-.487a.213.213 0 0 0-.306 0 .213.213 0 0 0 0 .306c.564.563 1.652.61 1.977.61zm.992-2.807c0 .458.373.83.831.83s.83-.381.83-.83a.831.831 0 0 0-1.66 0z"/><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.828-1.165c-.315 0-.602.124-.812.325-.801-.573-1.9-.945-3.121-.993l.534-2.501 1.738.372a.83.83 0 1 0 .83-.869.83.83 0 0 0-.744.468l-1.938-.41a.2.2 0 0 0-.153.028.2.2 0 0 0-.086.134l-.592 2.788c-1.24.038-2.358.41-3.17.992-.21-.2-.496-.324-.81-.324a1.163 1.163 0 0 0-.478 2.224q-.03.17-.029.353c0 1.795 2.091 3.256 4.669 3.256s4.668-1.451 4.668-3.256c0-.114-.01-.238-.029-.353.401-.181.688-.592.688-1.069 0-.65-.525-1.165-1.165-1.165"/></svg>
        </a>
      </nav>
    </div>
  </header>
  
          <section class="skill-page-header">
            <div class="skill-page-header-inner">
              <a href="../index.html" class="back-link">â† Back to Marketing & Sales</a>
              <div class="skill-page-meta">
                <a href="../index.html" class="skill-page-category">Marketing & Sales</a>
                <span class="skill-page-author">by @qlifebot-coder</span>
              </div>
              <h1 class="skill-page-title">ralph-loops</h1>
              <p class="skill-page-desc">> **First time?** Read [SETUP.md](./SETUP.md) first to install dependencies and verify your setup</p>
            </div>
          </section>
          <div class="skill-page-body">
            <article class="skill-page-content">
              <div class="skill-source-wrapper">
                <div class="skill-source-header">
                  <div class="skill-source-title">Source Code</div>
                  <button class="copy-btn" onclick="copySkillContent(this)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                    Copy
                  </button>
                </div>
                <div class="markdown-content">
                  <h1>Ralph Loops Skill</h1>
<blockquote>
<p><strong>First time?</strong> Read <a href="./SETUP.md">SETUP.md</a> first to install dependencies and verify your setup.</p>
</blockquote>
<p>Autonomous AI agent loops for iterative development. Based on Geoffrey Huntley&#39;s Ralph Wiggum technique, as documented by Clayton Farr.</p>
<p><strong>Script:</strong> <code>skills/ralph-loops/scripts/ralph-loop.mjs</code>
<strong>Dashboard:</strong> <code>skills/ralph-loops/dashboard/</code> (run with <code>node server.mjs</code>)
<strong>Templates:</strong> <code>skills/ralph-loops/templates/</code>
<strong>Archive:</strong> <code>~/clawd/logs/ralph-archive/</code></p>
<h2>âš ï¸ Don&#39;t Block the Conversation!</h2>
<p>When running a Ralph loop, <strong>don&#39;t monitor it synchronously</strong>. The loop runs as a separate Claude CLI process â€” you can keep chatting.</p>
<p><strong>âŒ Wrong (blocks conversation):</strong></p>
<pre><code>Start loop â†’ sleep 60 â†’ poll â†’ sleep 60 â†’ poll â†’ ... (6 minutes of silence)
</code></pre>
<p><strong>âœ… Right (stays responsive):</strong></p>
<pre><code>Start loop â†’ &quot;It&#39;s running, I&#39;ll check periodically&quot; â†’ keep chatting â†’ check on heartbeats
</code></pre>
<p><strong>How to monitor without blocking:</strong></p>
<ol>
<li>Start the loop with <code>node ralph-loop.mjs ...</code> (runs in background)</li>
<li>Tell human: &quot;Loop running. I&#39;ll check progress periodically or you can ask.&quot;</li>
<li>Check via <code>process poll &lt;sessionId&gt;</code> when asked or during heartbeats</li>
<li>Use the dashboard at <a href="http://localhost:3939">http://localhost:3939</a> for real-time visibility</li>
</ol>
<p><strong>The loop is autonomous</strong> â€” that&#39;s the whole point. Don&#39;t babysit it at the cost of ignoring your human.</p>
<hr>
<h2>Trigger Phrases</h2>
<p>When human says:</p>
<table>
<thead>
<tr>
<th>Phrase</th>
<th>Action</th>
</tr>
</thead>
<tbody><tr>
<td><strong>&quot;Interview me about system X&quot;</strong></td>
<td>Start Phase 1 requirements interview</td>
</tr>
<tr>
<td><strong>&quot;Start planning system X&quot;</strong></td>
<td>Run <code>./loop.sh plan</code> (needs specs first)</td>
</tr>
<tr>
<td><strong>&quot;Start building system X&quot;</strong></td>
<td>Run <code>./loop.sh build</code> (needs plan first)</td>
</tr>
<tr>
<td><strong>&quot;Ralph loop over X&quot;</strong></td>
<td><strong>ASK which phase</strong> (see below)</td>
</tr>
</tbody></table>
<h3>When Human Says &quot;Ralph Loop&quot; â€” Clarify the Phase!</h3>
<p>Don&#39;t assume which phase. Ask:</p>
<blockquote>
<p>&quot;Which type of Ralph loop are we doing?</p>
<p>1ï¸âƒ£ <strong>Interview</strong> â€” I&#39;ll ask you questions to build specs (Phase 1)
2ï¸âƒ£ <strong>Planning</strong> â€” I&#39;ll iterate on an implementation plan (Phase 2)<br>3ï¸âƒ£ <strong>Building</strong> â€” I&#39;ll implement from a plan, one task per iteration (Phase 3)
4ï¸âƒ£ <strong>Generic</strong> â€” Simple iterative refinement on a single topic&quot;</p>
</blockquote>
<p><strong>Then proceed based on their answer:</strong></p>
<table>
<thead>
<tr>
<th>Choice</th>
<th>Action</th>
</tr>
</thead>
<tbody><tr>
<td>Interview</td>
<td>Use <code>templates/requirements-interview.md</code> protocol</td>
</tr>
<tr>
<td>Planning</td>
<td>Need specs first â†’ run planning loop with <code>PROMPT_plan.md</code></td>
</tr>
<tr>
<td>Building</td>
<td>Need plan first â†’ run build loop with <code>PROMPT_build.md</code></td>
</tr>
<tr>
<td>Generic</td>
<td>Create prompt file, run <code>ralph-loop.mjs</code> directly</td>
</tr>
</tbody></table>
<h3>Generic Ralph Loop Flow (Phase 4)</h3>
<p>For simple iterative refinement (not full system builds):</p>
<ol>
<li><strong>Clarify the task</strong> â€” What exactly should be improved/refined?</li>
<li><strong>Create a prompt file</strong> â€” Save to <code>/tmp/ralph-prompt-&lt;task&gt;.md</code></li>
<li><strong>Set completion criteria</strong> â€” What signals &quot;done&quot;?</li>
<li><strong>Run the loop:</strong><pre><code class="language-bash">node skills/ralph-loops/scripts/ralph-loop.mjs \
  --prompt &quot;/tmp/ralph-prompt-&lt;task&gt;.md&quot; \
  --model opus \
  --max 10 \
  --done &quot;RALPH_DONE&quot;
</code></pre>
</li>
<li><strong>Or spawn as sub-agent</strong> for long-running tasks</li>
</ol>
<hr>
<h2>Core Philosophy</h2>
<blockquote>
<p>&quot;Human roles shift from &#39;telling the agent what to do&#39; to &#39;engineering conditions where good outcomes emerge naturally through iteration.&quot;
â€” Clayton Farr</p>
</blockquote>
<p>Three principles drive everything:</p>
<ol>
<li><strong>Context is scarce</strong> â€” With ~176K usable tokens from a 200K window, keep each iteration lean</li>
<li><strong>Plans are disposable</strong> â€” A drifting plan is cheaper to regenerate than salvage</li>
<li><strong>Backpressure beats direction</strong> â€” Engineer environments where wrong outputs get rejected automatically</li>
</ol>
<hr>
<h2>Three-Phase Workflow</h2>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 1: REQUIREMENTS                                              â”‚
â”‚  Human + LLM conversation â†’ JTBD â†’ Topics â†’ specs/*.md              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Phase 2: PLANNING                                                  â”‚
â”‚  Gap analysis (specs vs code) â†’ IMPLEMENTATION_PLAN.md              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Phase 3: BUILDING                                                  â”‚
â”‚  One task per iteration â†’ fresh context â†’ backpressure â†’ commit     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3>Phase 1: Requirements (Talk to Human)</h3>
<p><strong>Goal:</strong> Understand what to build BEFORE building it.</p>
<p>This is the most important phase. Use structured conversation to:</p>
<ol>
<li><p><strong>Identify Jobs to Be Done (JTBD)</strong></p>
<ul>
<li>What user need or outcome are we solving?</li>
<li>Not features â€” outcomes</li>
</ul>
</li>
<li><p><strong>Break JTBD into Topics of Concern</strong></p>
<ul>
<li>Each topic = one distinct aspect/component</li>
<li>Use the &quot;one sentence without &#39;and&#39;&quot; test</li>
<li>âœ“ &quot;The color extraction system analyzes images to identify dominant colors&quot;</li>
<li>âœ— &quot;The user system handles authentication, profiles, and billing&quot; â†’ 3 topics</li>
</ul>
</li>
<li><p><strong>Create Specs for Each Topic</strong></p>
<ul>
<li>One markdown file per topic in <code>specs/</code></li>
<li>Capture requirements, acceptance criteria, edge cases</li>
</ul>
</li>
</ol>
<p><strong>Template:</strong> <code>templates/requirements-interview.md</code></p>
<h3>Phase 2: Planning (Gap Analysis)</h3>
<p><strong>Goal:</strong> Create a prioritized task list without implementing anything.</p>
<p>Uses <code>PROMPT_plan.md</code> in the loop:</p>
<ul>
<li>Study all specs</li>
<li>Study existing codebase</li>
<li>Compare specs vs code (gap analysis)</li>
<li>Generate <code>IMPLEMENTATION_PLAN.md</code> with prioritized tasks</li>
<li><strong>NO implementation</strong> â€” planning only</li>
</ul>
<p>Usually completes in 1-2 iterations.</p>
<h3>Phase 3: Building (One Task Per Iteration)</h3>
<p><strong>Goal:</strong> Implement tasks one at a time with fresh context.</p>
<p>Uses <code>PROMPT_build.md</code> in the loop:</p>
<ol>
<li>Read <code>IMPLEMENTATION_PLAN.md</code></li>
<li>Pick the most important task</li>
<li>Investigate codebase (don&#39;t assume not implemented)</li>
<li>Implement</li>
<li>Run validation (backpressure)</li>
<li>Update plan, commit</li>
<li>Exit â†’ fresh context â†’ next iteration</li>
</ol>
<p><strong>Key insight:</strong> One task per iteration keeps context lean. The agent stays in the &quot;smart zone&quot; instead of accumulating cruft.</p>
<p><strong>Why fresh context matters:</strong></p>
<ul>
<li><strong>No accumulated mistakes</strong> â€” Each iteration starts clean; previous errors don&#39;t compound</li>
<li><strong>Full context budget</strong> â€” 200K tokens for THIS task, not shared with finished work</li>
<li><strong>Reduced hallucination</strong> â€” Shorter contexts = more grounded responses</li>
<li><strong>Natural checkpoints</strong> â€” Each commit is a save point; easy to revert single iterations</li>
</ul>
<hr>
<h2>File Structure</h2>
<pre><code>project/
â”œâ”€â”€ loop.sh                    # Ralph loop script
â”œâ”€â”€ PROMPT_plan.md             # Planning mode instructions
â”œâ”€â”€ PROMPT_build.md            # Building mode instructions  
â”œâ”€â”€ AGENTS.md                  # Operational guide (~60 lines max)
â”œâ”€â”€ IMPLEMENTATION_PLAN.md     # Prioritized task list (generated)
â””â”€â”€ specs/                     # Requirement specs
    â”œâ”€â”€ topic-a.md
    â”œâ”€â”€ topic-b.md
    â””â”€â”€ ...
</code></pre>
<h3>File Purposes</h3>
<table>
<thead>
<tr>
<th>File</th>
<th>Purpose</th>
<th>Who Creates</th>
</tr>
</thead>
<tbody><tr>
<td><code>specs/*.md</code></td>
<td>Source of truth for requirements</td>
<td>Human + Phase 1</td>
</tr>
<tr>
<td><code>PROMPT_plan.md</code></td>
<td>Instructions for planning mode</td>
<td>Copy from template</td>
</tr>
<tr>
<td><code>PROMPT_build.md</code></td>
<td>Instructions for building mode</td>
<td>Copy from template</td>
</tr>
<tr>
<td><code>AGENTS.md</code></td>
<td>Build/test/lint commands</td>
<td>Human + Ralph</td>
</tr>
<tr>
<td><code>IMPLEMENTATION_PLAN.md</code></td>
<td>Task list with priorities</td>
<td>Ralph (Phase 2)</td>
</tr>
</tbody></table>
<h3>Project Organization (Systems)</h3>
<p>For Clawdbot systems, each Ralph project lives in <code>&lt;workspace&gt;/systems/&lt;name&gt;/</code>:</p>
<pre><code>systems/
â”œâ”€â”€ health-tracker/           # Example system
â”‚   â”œâ”€â”€ specs/
â”‚   â”‚   â”œâ”€â”€ daily-tracking.md
â”‚   â”‚   â””â”€â”€ test-scheduling.md
â”‚   â”œâ”€â”€ PROMPT_plan.md
â”‚   â”œâ”€â”€ PROMPT_build.md
â”‚   â”œâ”€â”€ AGENTS.md
â”‚   â”œâ”€â”€ IMPLEMENTATION_PLAN.md  # â† exists = past Phase 1
â”‚   â””â”€â”€ src/
â””â”€â”€ activity-planner/
    â”œâ”€â”€ specs/                  # â† empty = still in Phase 1
    â””â”€â”€ ...
</code></pre>
<h3>Phase Detection (Auto)</h3>
<p>Detect current phase by checking what files exist:</p>
<table>
<thead>
<tr>
<th>What Exists</th>
<th>Current Phase</th>
<th>Next Action</th>
</tr>
</thead>
<tbody><tr>
<td>Nothing / empty <code>specs/</code></td>
<td>Phase 1: Requirements</td>
<td>Run requirements interview</td>
</tr>
<tr>
<td><code>specs/*.md</code> but no <code>IMPLEMENTATION_PLAN.md</code></td>
<td>Ready for Phase 2</td>
<td>Run <code>./loop.sh plan</code></td>
</tr>
<tr>
<td><code>specs/*.md</code> + <code>IMPLEMENTATION_PLAN.md</code></td>
<td>Phase 2 or 3</td>
<td>Review plan, run <code>./loop.sh build</code></td>
</tr>
<tr>
<td>Plan shows all tasks complete</td>
<td>Done</td>
<td>Archive or iterate</td>
</tr>
</tbody></table>
<p><strong>Quick check:</strong></p>
<pre><code class="language-bash"># What phase are we in?
[ -z &quot;$(ls specs/ 2&gt;/dev/null)&quot; ] &amp;&amp; echo &quot;Phase 1: Need specs&quot; &amp;&amp; exit
[ ! -f IMPLEMENTATION_PLAN.md ] &amp;&amp; echo &quot;Phase 2: Need plan&quot; &amp;&amp; exit
echo &quot;Phase 3: Ready to build (or done)&quot;
</code></pre>
<hr>
<h2>JTBD Breakdown</h2>
<p>The hierarchy matters:</p>
<pre><code>JTBD (Job to Be Done)
â””â”€â”€ Topic of Concern (1 per spec file)
    â””â”€â”€ Tasks (many per topic, in IMPLEMENTATION_PLAN.md)
</code></pre>
<p><strong>Example:</strong></p>
<ul>
<li><strong>JTBD:</strong> &quot;Help designers create mood boards&quot;</li>
<li><strong>Topics:</strong><ul>
<li>Image collection â†’ <code>specs/image-collection.md</code></li>
<li>Color extraction â†’ <code>specs/color-extraction.md</code></li>
<li>Layout system â†’ <code>specs/layout-system.md</code></li>
<li>Sharing â†’ <code>specs/sharing.md</code></li>
</ul>
</li>
<li><strong>Tasks:</strong> Each spec generates multiple implementation tasks</li>
</ul>
<h3>Topic Scope Test</h3>
<blockquote>
<p>Can you describe the topic in one sentence without &quot;and&quot;?</p>
</blockquote>
<p>If you need &quot;and&quot; or &quot;also&quot;, it&#39;s probably multiple topics. Split it.</p>
<p><strong>When to split:</strong></p>
<ul>
<li>Multiple verbs in the description â†’ separate topics</li>
<li>Different user personas involved â†’ separate topics</li>
<li>Could be implemented by different teams â†’ separate topics</li>
<li>Has its own failure modes â†’ probably its own topic</li>
</ul>
<p><strong>Example split:</strong></p>
<pre><code>âŒ &quot;User management handles registration, authentication, profiles, and permissions&quot;

âœ… Split into:
   - &quot;Registration creates new user accounts from email/password&quot;
   - &quot;Authentication verifies user identity via login flow&quot;  
   - &quot;Profiles let users view and edit their information&quot;
   - &quot;Permissions control what actions users can perform&quot;
</code></pre>
<p><strong>Counter-example (don&#39;t split):</strong></p>
<pre><code>âœ… Keep together:
   &quot;Color extraction analyzes images and returns dominant color palettes&quot;
   
   Why: &quot;analyzes&quot; and &quot;returns&quot; are steps in one operation, not separate concerns.
</code></pre>
<hr>
<h2>Backpressure Mechanisms</h2>
<p>Autonomous loops converge when wrong outputs get rejected. Three layers:</p>
<h3>1. Downstream Gates (Hard)</h3>
<p>Tests, type-checking, linting, build validation. Deterministic.</p>
<pre><code class="language-markdown"># In AGENTS.md
## Validation
- Tests: `npm test`
- Typecheck: `npm run typecheck`
- Lint: `npm run lint`
</code></pre>
<h3>2. Upstream Steering (Soft)</h3>
<p>Existing code patterns guide the agent. It discovers conventions through exploration.</p>
<h3>3. LLM-as-Judge (Subjective)</h3>
<p>For subjective criteria (tone, UX, aesthetics), use another LLM call with binary pass/fail.</p>
<blockquote>
<p>Start with hard gates. Add LLM-as-judge for subjective criteria only after mechanical backpressure works.</p>
</blockquote>
<hr>
<h2>Prompt Structure</h2>
<p>Geoffrey&#39;s prompts follow a numbered pattern:</p>
<table>
<thead>
<tr>
<th>Section</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td>0a-0d</td>
<td><strong>Orient:</strong> Study specs, source, current plan</td>
</tr>
<tr>
<td>1-4</td>
<td><strong>Main instructions:</strong> What to do this iteration</td>
</tr>
<tr>
<td>999+</td>
<td><strong>Guardrails:</strong> Invariants (higher number = more critical)</td>
</tr>
</tbody></table>
<h3>The Numbered Guardrails Pattern</h3>
<p>Guardrails use escalating numbers (99999, 999999, 9999999...) to signal priority:</p>
<pre><code class="language-markdown">99999. Important: Capture the why in documentation.

999999. Important: Single sources of truth, no migrations.

9999999. Create git tags after successful builds.

99999999. Add logging if needed to debug.

999999999. Keep IMPLEMENTATION_PLAN.md current.
</code></pre>
<p><strong>Why this works:</strong></p>
<ol>
<li><strong>Visual prominence</strong> â€” Large numbers stand out, harder to skip</li>
<li><strong>Implicit priority</strong> â€” More 9s = more critical (like DEFCON levels in reverse)</li>
<li><strong>No collisions</strong> â€” Sparse numbering lets you insert new rules without renumbering</li>
<li><strong>Mnemonic</strong> â€” Claude treats these as invariants, not suggestions</li>
</ol>
<p><strong>The &quot;Important:&quot; prefix</strong> is deliberate â€” it triggers Claude&#39;s attention.</p>
<h3>Key Language Patterns</h3>
<p>Use Geoffrey&#39;s specific phrasing â€” it matters:</p>
<ul>
<li>&quot;study&quot; (not &quot;read&quot; or &quot;look at&quot;)</li>
<li>&quot;don&#39;t assume not implemented&quot; (critical!)</li>
<li>&quot;using parallel subagents&quot; / &quot;up to N subagents&quot;</li>
<li>&quot;only 1 subagent for build/tests&quot; (backpressure control)</li>
<li>&quot;Ultrathink&quot; (deep reasoning trigger)</li>
<li>&quot;capture the why&quot;</li>
<li>&quot;keep it up to date&quot;</li>
<li>&quot;resolve them or document them&quot;</li>
</ul>
<hr>
<h2>Quick Start</h2>
<h3>1. Set Up Project Structure</h3>
<pre><code class="language-bash">mkdir -p myproject/specs
cd myproject
git init  # Ralph expects git for commits

# Copy templates
cp .//templates/PROMPT_plan.md .
cp .//templates/PROMPT_build.md .
cp .//templates/AGENTS.md .
cp .//templates/loop.sh .
chmod +x loop.sh
</code></pre>
<h3>2. Customize Templates (Required!)</h3>
<p><strong>PROMPT_plan.md</strong> â€” Replace <code>[PROJECT_GOAL]</code> with your actual goal:</p>
<pre><code class="language-markdown"># Before:
ULTIMATE GOAL: We want to achieve [PROJECT_GOAL].

# After:
ULTIMATE GOAL: We want to achieve a fully functional mood board app with image upload and color extraction.
</code></pre>
<p><strong>PROMPT_build.md</strong> â€” Adjust source paths if not using <code>src/</code>:</p>
<pre><code class="language-markdown"># Before:
0c. For reference, the application source code is in `src/*`.

# After:
0c. For reference, the application source code is in `lib/*`.
</code></pre>
<p><strong>AGENTS.md</strong> â€” Update build/test/lint commands for your stack.</p>
<h3>3. Phase 1: Requirements Gathering (Don&#39;t Skip!)</h3>
<p>This phase happens WITH the human. Use the interview template:</p>
<pre><code class="language-bash">cat .//templates/requirements-interview.md
</code></pre>
<p><strong>The workflow:</strong></p>
<ol>
<li>Discuss the JTBD (Job to Be Done) â€” outcomes, not features</li>
<li>Break into Topics of Concern (each passes the &quot;one sentence&quot; test)</li>
<li>Write a spec file for each topic: <code>specs/topic-name.md</code></li>
<li>Human reviews and approves specs</li>
</ol>
<p><strong>Example output:</strong></p>
<pre><code>specs/
â”œâ”€â”€ image-collection.md
â”œâ”€â”€ color-extraction.md
â”œâ”€â”€ layout-system.md
â””â”€â”€ sharing.md
</code></pre>
<h3>4. Phase 2: Planning</h3>
<pre><code class="language-bash">./loop.sh plan
</code></pre>
<p>Wait for <code>IMPLEMENTATION_PLAN.md</code> to be generated (usually 1-2 iterations). Review it â€” this is your task list.</p>
<h3>5. Phase 3: Building</h3>
<pre><code class="language-bash">./loop.sh build 20  # Max 20 iterations
</code></pre>
<p>Watch it work. Add backpressure (tests, lints) as patterns emerge. Check commits for progress.</p>
<hr>
<h2>Loop Script Options</h2>
<pre><code class="language-bash">./loop.sh              # Build mode, unlimited
./loop.sh 20           # Build mode, max 20 iterations
./loop.sh plan         # Plan mode, unlimited
./loop.sh plan 5       # Plan mode, max 5 iterations
</code></pre>
<p>Or use the Node.js wrapper for more control:</p>
<pre><code class="language-bash">node skills/ralph-loops/scripts/ralph-loop.mjs \
  --prompt &quot;./PROMPT_build.md&quot; \
  --model opus \
  --max 20 \
  --done &quot;RALPH_DONE&quot;
</code></pre>
<hr>
<h2>When to Regenerate the Plan</h2>
<p>Plans drift. Regenerate when:</p>
<ul>
<li>Ralph is going off track (implementing wrong things)</li>
<li>Plan feels stale or doesn&#39;t match current state</li>
<li>Too much clutter from completed items</li>
<li>You&#39;ve made significant spec changes</li>
<li>You&#39;re confused about what&#39;s actually done</li>
</ul>
<p>Just switch back to planning mode:</p>
<pre><code class="language-bash">./loop.sh plan
</code></pre>
<p>Regeneration cost is one Planning loop. Cheap compared to Ralph going in circles.</p>
<hr>
<h2>Safety</h2>
<p>Ralph requires <code>--dangerously-skip-permissions</code> to run autonomously. This bypasses Claude&#39;s permission system entirely.</p>
<p><strong>Philosophy:</strong> &quot;It&#39;s not if it gets popped, it&#39;s when. And what is the blast radius?&quot;</p>
<p><strong>Protections:</strong></p>
<ul>
<li>Run in isolated environments (Docker, VM)</li>
<li>Only the API keys needed for the task</li>
<li>No access to private data beyond requirements</li>
<li>Restrict network connectivity where possible</li>
<li><strong>Escape hatches:</strong> Ctrl+C stops the loop; <code>git reset --hard</code> reverts uncommitted changes</li>
</ul>
<hr>
<h2>Cost Expectations</h2>
<table>
<thead>
<tr>
<th>Task Type</th>
<th>Model</th>
<th>Iterations</th>
<th>Est. Cost</th>
</tr>
</thead>
<tbody><tr>
<td>Generate plan</td>
<td>Opus</td>
<td>1-2</td>
<td>$0.50-1.00</td>
</tr>
<tr>
<td>Implement simple feature</td>
<td>Opus</td>
<td>3-5</td>
<td>$1.00-2.00</td>
</tr>
<tr>
<td>Implement complex feature</td>
<td>Opus</td>
<td>10-20</td>
<td>$3.00-8.00</td>
</tr>
<tr>
<td>Full project buildout</td>
<td>Opus</td>
<td>50+</td>
<td>$15-50+</td>
</tr>
</tbody></table>
<p><strong>Tip:</strong> Use Sonnet for simpler tasks where plan is clear. Use Opus for planning and complex reasoning.</p>
<hr>
<h2>Real-World Results</h2>
<p>From Geoffrey Huntley:</p>
<ul>
<li>6 repos generated overnight at YC hackathon</li>
<li>$50k contract completed for $297 in API costs</li>
<li>Created entire programming language over 3 months</li>
</ul>
<hr>
<h2>Advanced: Running as Sub-Agent</h2>
<p>For long loops, spawn as sub-agent so main session stays responsive:</p>
<pre><code class="language-javascript">sessions_spawn({
  task: `cd /path/to/project &amp;&amp; ./loop.sh build 20
         
Summarize what was implemented when done.`,
  label: &quot;ralph-build&quot;,
  model: &quot;opus&quot;
})
</code></pre>
<p>Check progress:</p>
<pre><code class="language-javascript">sessions_list({ kinds: [&quot;spawn&quot;] })
sessions_history({ label: &quot;ralph-build&quot;, limit: 5 })
</code></pre>
<hr>
<h2>Troubleshooting</h2>
<h3>Ralph keeps implementing the same thing</h3>
<ul>
<li>Plan is stale â†’ regenerate with <code>./loop.sh plan</code></li>
<li>Backpressure missing â†’ add tests that catch duplicates</li>
</ul>
<h3>Ralph goes in circles</h3>
<ul>
<li>Add more specific guardrails to prompts</li>
<li>Check if specs are ambiguous</li>
<li>Regenerate plan</li>
</ul>
<h3>Context getting bloated</h3>
<ul>
<li>Ensure one task per iteration (check prompt)</li>
<li>Keep AGENTS.md under 60 lines</li>
<li>Move status/progress to IMPLEMENTATION_PLAN.md, not AGENTS.md</li>
</ul>
<h3>Tests not running</h3>
<ul>
<li>Check AGENTS.md has correct validation commands</li>
<li>Ensure backpressure section in prompt references AGENTS.md</li>
</ul>
<hr>
<h2>Edge Cases</h2>
<h3>Projects Without Git</h3>
<p>The loop script expects git for commits and pushes. For projects without version control:</p>
<p><strong>Option 1: Initialize git anyway</strong> (recommended)</p>
<pre><code class="language-bash">git init
git add -A
git commit -m &quot;Initial commit before Ralph&quot;
</code></pre>
<p><strong>Option 2: Modify the prompts</strong></p>
<ul>
<li>Remove git-related guardrails from PROMPT_build.md</li>
<li>Remove the git push section from loop.sh</li>
<li>Use file backups instead: add <code>cp -r src/ backups/iteration-$ITERATION/</code> to loop.sh</li>
</ul>
<p><strong>Option 3: Use tarball snapshots</strong></p>
<pre><code class="language-bash"># Add to loop.sh before each iteration:
tar -czf &quot;snapshots/pre-iteration-$ITERATION.tar.gz&quot; src/
</code></pre>
<h3>Very Large Codebases</h3>
<p>For codebases with 100K+ lines:</p>
<ul>
<li><strong>Reduce subagent parallelism:</strong> Change &quot;up to 500 parallel Sonnet subagents&quot; to &quot;up to 50&quot; in prompts</li>
<li><strong>Scope narrowly:</strong> Use focused specs that target specific directories</li>
<li><strong>Add path restrictions:</strong> In AGENTS.md, note which directories are in-scope</li>
<li><strong>Consider workspace splitting:</strong> Treat large modules as separate Ralph projects</li>
</ul>
<h3>When Claude CLI Isn&#39;t Available</h3>
<p>The methodology works with any Claude interface:</p>
<p><strong>Claude API directly:</strong></p>
<pre><code class="language-bash"># Replace loop.sh with API calls using curl or a script
curl https://api.anthropic.com/v1/messages \
  -H &quot;x-api-key: $ANTHROPIC_API_KEY&quot; \
  -H &quot;content-type: application/json&quot; \
  -d &#39;{&quot;model&quot;: &quot;claude-sonnet-4-20250514&quot;, &quot;max_tokens&quot;: 8192, &quot;messages&quot;: [...]}&#39;
</code></pre>
<p><strong>Alternative agents:</strong></p>
<ul>
<li><strong>Aider:</strong> <code>aider --opus --auto-commits</code></li>
<li><strong>Continue.dev:</strong> Use with Claude API key</li>
<li><strong>Cursor:</strong> Composer mode with PROMPT files as context</li>
</ul>
<p>The key principles (one task per iteration, fresh context, backpressure) apply regardless of tooling.</p>
<h3>Non-Node.js Projects</h3>
<p>Adapt AGENTS.md for your stack:</p>
<table>
<thead>
<tr>
<th>Stack</th>
<th>Build</th>
<th>Test</th>
<th>Lint</th>
</tr>
</thead>
<tbody><tr>
<td>Python</td>
<td><code>pip install -e .</code></td>
<td><code>pytest</code></td>
<td><code>ruff .</code></td>
</tr>
<tr>
<td>Go</td>
<td><code>go build ./...</code></td>
<td><code>go test ./...</code></td>
<td><code>golangci-lint run</code></td>
</tr>
<tr>
<td>Rust</td>
<td><code>cargo build</code></td>
<td><code>cargo test</code></td>
<td><code>cargo clippy</code></td>
</tr>
<tr>
<td>Ruby</td>
<td><code>bundle install</code></td>
<td><code>rspec</code></td>
<td><code>rubocop</code></td>
</tr>
</tbody></table>
<p>Also update path references in prompts (<code>src/*</code> â†’ your source directory).</p>
<hr>
<h2>Learn More</h2>
<ul>
<li>Geoffrey Huntley: <a href="https://ghuntley.com/ralph/">https://ghuntley.com/ralph/</a></li>
<li>Clayton Farr&#39;s Playbook: <a href="https://github.com/ClaytonFarr/ralph-playbook">https://github.com/ClaytonFarr/ralph-playbook</a></li>
<li>Geoffrey&#39;s Fork: <a href="https://github.com/ghuntley/how-to-ralph-wiggum">https://github.com/ghuntley/how-to-ralph-wiggum</a></li>
</ul>
<hr>
<h2>Credits</h2>
<p>Built by <strong>Johnathan &amp; Q</strong> â€” a human-AI dyad.</p>
<ul>
<li>Twitter: <a href="https://x.com/spacepixel">@spacepixel</a></li>
<li>ClawdHub: <a href="https://www.clawhub.ai/skills/ralph-loops">clawhub.ai/skills/ralph-loops</a></li>
</ul>

                </div>
              </div>
            </article>
            <aside class="skill-page-sidebar">
              <div class="sidebar-card">
                <div class="sidebar-title">Actions</div>
                <a href="https://github.com/openclaw/skills/tree/main/skills/qlifebot-coder/ralph-loops/SKILL.md" target="_blank" rel="noopener" class="sidebar-btn sidebar-btn-primary">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/></svg>
                  View on GitHub
                </a>
                <a href="https://clawdhub.com/qlifebot-coder/ralph-loops" target="_blank" rel="noopener" class="sidebar-btn sidebar-btn-clawdhub">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/><line x1="2" y1="12" x2="22" y2="12"/></svg>
                  View on ClawdHub
                </a>
                <a href="https://raw.githubusercontent.com/openclaw/skills/main/skills/qlifebot-coder/ralph-loops/SKILL.md" download="SKILL.md" class="sidebar-btn sidebar-btn-secondary">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                  Download SKILL.md
                </a>
                <button onclick="sendToSecurityAuditor()" class="sidebar-btn sidebar-btn-security">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                  Security Check
                </button>
              </div>
              <div class="sidebar-card">
                <div class="sidebar-title">Details</div>
                <div class="sidebar-info">
                  <div class="sidebar-info-item">
                    <span class="sidebar-info-label">Author</span>
                    <span class="sidebar-info-value">@qlifebot-coder</span>
                  </div>
                  <div class="sidebar-info-item">
                    <span class="sidebar-info-label">Category</span>
                    <span class="sidebar-info-value">Marketing & Sales</span>
                  </div>
                </div>
              </div>
            </aside>
          </div>
        
  <footer class="footer">
    <div class="footer-inner">
      <p class="footer-text" style="margin-bottom: 8px;"><a href="https://github.com/neonone123/moltdirectory" target="_blank" rel="noopener" style="color: var(--accent); text-decoration: none;">View on GitHub</a></p>
      <p class="footer-text" style="opacity: 0.6; font-size: 13px;">MoltDirectory.com is a community-run project and is not affiliated with the official MoltBot team or Peter Steinberger. We are just fans of the lobster.</p>
    </div>
  </footer>
  <script>
    function toggleTheme() {
      const html = document.documentElement;
      const currentTheme = html.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      if (newTheme === 'light') {
        html.setAttribute('data-theme', 'light');
      } else {
        html.removeAttribute('data-theme');
      }
      localStorage.setItem('theme', newTheme);
    }
    
    function copySkillContent(btn) {
      const wrapper = btn.closest('.skill-source-wrapper');
      const content = wrapper.querySelector('.markdown-content');
      if (content) {
        const text = content.innerText || content.textContent;
        navigator.clipboard.writeText(text).then(() => {
          btn.classList.add('copied');
          btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg> Copied!';
          setTimeout(() => {
            btn.classList.remove('copied');
            btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copy';
          }, 2000);
        });
      }
    }

    async function sendToSecurityAuditor() {
      try {
        const contentElement = document.querySelector('.markdown-content');
        if (!contentElement) throw new Error('Could not find markdown content');
        const skillContent = contentElement.innerText || contentElement.textContent;
        localStorage.setItem('skillAuditContent', skillContent);
        window.open('/security-auditor', '_blank'); 
      } catch (error) {
        alert('Error: ' + error.message);
      }
    }
  </script>
</body>
</html>